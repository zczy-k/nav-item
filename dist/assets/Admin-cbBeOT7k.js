import{_ as I,r as h,g as L,c as g,o as r,b as e,w,v as f,q as x,F as A,a as S,n as U,t as C,e as D,y as F,z as H,j as E,d as V,A as P,l as N,B as q,C as T,D as j}from"./index-BNZTRbzF.js";import{g as O,n as K,o as R,q as G,r as J,s as Q,t as W,v as X,u as Y,k as Z,d as ee,a as te,w as le,x as ne,y as se,b as oe,z as ae,A as ie,B as de,C as ue,D as re,l as ce}from"./api-DRjpqTxD.js";const ve={class:"menu-manage"},pe={class:"menu-header"},me={class:"menu-add"},he={class:"menu-content"},ge={class:"menu-list"},be={class:"main-menu"},we={class:"menu-info"},ke=["onUpdate:modelValue","onBlur"],_e={class:"menu-order"},fe=["onUpdate:modelValue","onBlur"],$e={class:"menu-actions"},ye=["onClick","title"],Me=["onClick"],Ce={class:"sub-menu-header"},Be={class:"sub-menu-title"},Ve=["onClick"],Ue={key:0,class:"sub-menu-list"},xe={class:"sub-menu-info"},Ae=["onUpdate:modelValue","onBlur"],Se={class:"sub-menu-order"},Ie=["onUpdate:modelValue","onBlur"],Le={class:"sub-menu-actions"},ze=["onClick"],Te={key:1,class:"empty-sub-menu"},He=["onClick"],Fe={__name:"MenuManage",setup(z){const s=h([]),c=h("");L(u);async function u(){const t=await O();s.value=t.data.map(l=>({...l,showSubMenu:!1}))}async function a(){if(!c.value.trim())return;const t=s.value.length?Math.max(...s.value.map(l=>l.order||0)):0;await K({name:c.value.trim(),order:t+1}),c.value="",u()}async function b(t){await R(t.id,{name:t.name,order:t.order}),u()}async function $(t){confirm("确定要删除这个主菜单吗？删除后将同时删除其下的所有子菜单和卡片。")&&(await G(t),u())}async function y(t){const l=s.value.find(n=>n.id===t),o=prompt("请输入子菜单名称：");if(!o?.trim())return;const i=l.subMenus?.length?Math.max(...l.subMenus.map(n=>n.order||0)):0;await J(t,{name:o.trim(),order:i+1}),u()}async function M(t){await Q(t.id,{name:t.name,order:t.order}),u()}async function k(t){confirm("确定要删除这个子菜单吗？删除后将同时删除其下的所有卡片。")&&(await W(t),u())}function v(t){const l=s.value.find(o=>o.id===t);l&&(l.showSubMenu=!l.showSubMenu)}return(t,l)=>(r(),g("div",ve,[e("div",pe,[l[2]||(l[2]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"管理主菜单和子菜单")],-1)),e("div",me,[w(e("input",{"onUpdate:modelValue":l[0]||(l[0]=o=>c.value=o),placeholder:"请输入主菜单名称",class:"input"},null,512),[[f,c.value]]),e("button",{class:"btn btn-primary",onClick:a},l[1]||(l[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),x(" 添加主菜单 ")]))])]),e("div",he,[e("div",ge,[(r(!0),g(A,null,S(s.value,o=>(r(),g("div",{key:o.id,class:"menu-item"},[e("div",be,[e("div",we,[l[4]||(l[4]=e("div",{class:"menu-icon"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 3h18v18H3zM9 9h6v6H9z"})])],-1)),w(e("input",{"onUpdate:modelValue":i=>o.name=i,onBlur:i=>b(o),class:"menu-name-input"},null,40,ke),[[f,o.name]]),e("div",_e,[l[3]||(l[3]=e("span",{class:"order-label"},"排序",-1)),w(e("input",{"onUpdate:modelValue":i=>o.order=i,type:"number",onBlur:i=>b(o),class:"order-input"},null,40,fe),[[f,o.order,void 0,{number:!0}]])])]),e("div",$e,[e("button",{class:"btn btn-icon expand-btn",onClick:i=>v(o.id),title:o.showSubMenu?"收起子菜单":"展开子菜单"},l[5]||(l[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"m6 9 6 6 6-6"})],-1)]),8,ye),e("button",{class:"btn btn-danger btn-icon",onClick:i=>$(o.id),title:"删除主菜单"},l[6]||(l[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,Me)])]),e("div",{class:U(["sub-menu-section",{expanded:o.showSubMenu}])},[e("div",Ce,[e("div",Be,[l[7]||(l[7]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 11H1l8-8 8 8h-8v8z"})],-1)),x(" 子菜单 ("+C(o.subMenus?.length||0)+") ",1)]),e("button",{class:"btn btn-sm btn-outline",onClick:i=>y(o.id)},l[8]||(l[8]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),x(" 添加子菜单 ")]),8,Ve)]),o.subMenus&&o.subMenus.length>0?(r(),g("div",Ue,[(r(!0),g(A,null,S(o.subMenus,i=>(r(),g("div",{key:i.id,class:"sub-menu-item"},[e("div",xe,[l[9]||(l[9]=e("div",{class:"sub-menu-icon"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 6h16M4 12h16M4 18h16"})])],-1)),w(e("input",{"onUpdate:modelValue":n=>i.name=n,onBlur:n=>M(i),class:"sub-menu-name-input"},null,40,Ae),[[f,i.name]]),e("div",Se,[w(e("input",{"onUpdate:modelValue":n=>i.order=n,type:"number",onBlur:n=>M(i),class:"order-input"},null,40,Ie),[[f,i.order,void 0,{number:!0}]])])]),e("div",Le,[e("button",{class:"btn btn-danger btn-icon btn-sm",onClick:n=>k(i.id),title:"删除子菜单"},l[10]||(l[10]=[e("svg",{width:"14",height:"14",viewBox:"0 0 22 22",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,ze)])]))),128))])):(r(),g("div",Te,[l[11]||(l[11]=e("p",null,"暂无子菜单",-1)),e("button",{class:"btn btn-sm btn-outline",onClick:i=>y(o.id)},"添加第一个子菜单",8,He)]))],2)]))),128))])])]))}},Pe=I(Fe,[["__scopeId","data-v-5964fa59"]]),Ne={class:"card-manage"},je={class:"card-header"},De={class:"card-add"},Ee=["value"],Oe=["value"],qe={class:"card-card"},Ke={class:"card-table"},Re=["onUpdate:modelValue","onBlur"],Ge=["onUpdate:modelValue","onBlur"],Je=["onUpdate:modelValue","onBlur"],Qe=["onUpdate:modelValue","onBlur"],We=["onUpdate:modelValue","onBlur"],Xe=["onClick"],Ye={__name:"CardManage",setup(z){const s=h([]),c=h([]),u=h(),a=h(""),b=h(""),$=h(""),y=h(""),M=D(()=>u.value?s.value.find(m=>m.id===u.value)?.subMenus||[]:[]);L(async()=>{const n=await O();s.value=n.data,s.value.length&&(u.value=s.value[0].id,a.value="")}),F(u,()=>{a.value="",t()}),F(a,t);function k(){a.value=""}function v(){t()}async function t(){if(!u.value)return;const n=await ee(u.value,a.value||null);c.value=n.data}async function l(){!b.value||!$.value||(await X({menu_id:u.value,sub_menu_id:a.value||null,title:b.value,url:$.value,logo_url:y.value}),b.value="",$.value="",y.value="",t())}async function o(n){await Y(n.id,{menu_id:u.value,sub_menu_id:a.value||null,title:n.title,url:n.url,logo_url:n.logo_url,desc:n.desc,order:n.order}),t()}async function i(n){await Z(n),t()}return(n,m)=>(r(),g("div",Ne,[e("div",je,[m[7]||(m[7]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"管理网站导航卡片，支持主菜单和子菜单分类")],-1)),e("div",De,[w(e("select",{"onUpdate:modelValue":m[0]||(m[0]=d=>u.value=d),class:"input narrow",onChange:k},[(r(!0),g(A,null,S(s.value,d=>(r(),g("option",{value:d.id,key:d.id},C(d.name),9,Ee))),128))],544),[[H,u.value]]),w(e("select",{"onUpdate:modelValue":m[1]||(m[1]=d=>a.value=d),class:"input narrow",onChange:v},[m[5]||(m[5]=e("option",{value:""},"主菜单",-1)),(r(!0),g(A,null,S(M.value,d=>(r(),g("option",{value:d.id,key:d.id},C(d.name),9,Oe))),128))],544),[[H,a.value]]),w(e("input",{"onUpdate:modelValue":m[2]||(m[2]=d=>b.value=d),placeholder:"卡片标题",class:"input narrow"},null,512),[[f,b.value]]),w(e("input",{"onUpdate:modelValue":m[3]||(m[3]=d=>$.value=d),placeholder:"卡片链接",class:"input wide"},null,512),[[f,$.value]]),w(e("input",{"onUpdate:modelValue":m[4]||(m[4]=d=>y.value=d),placeholder:"logo链接(可选)",class:"input wide"},null,512),[[f,y.value]]),e("button",{class:"btn",onClick:l},m[6]||(m[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),x(" 添加卡片 ")]))])]),e("div",qe,[e("table",Ke,[m[9]||(m[9]=e("thead",null,[e("tr",null,[e("th",null,"标题"),e("th",null,"网址"),e("th",null,"Logo链接"),e("th",null,"描述"),e("th",null,"排序"),e("th",null,"操作")])],-1)),e("tbody",null,[(r(!0),g(A,null,S(c.value,d=>(r(),g("tr",{key:d.id},[e("td",null,[w(e("input",{"onUpdate:modelValue":_=>d.title=_,onBlur:_=>o(d),class:"table-input"},null,40,Re),[[f,d.title]])]),e("td",null,[w(e("input",{"onUpdate:modelValue":_=>d.url=_,onBlur:_=>o(d),class:"table-input"},null,40,Ge),[[f,d.url]])]),e("td",null,[w(e("input",{"onUpdate:modelValue":_=>d.logo_url=_,onBlur:_=>o(d),class:"table-input",placeholder:"logo链接(可选)"},null,40,Je),[[f,d.logo_url]])]),e("td",null,[w(e("input",{"onUpdate:modelValue":_=>d.desc=_,onBlur:_=>o(d),class:"table-input",placeholder:"描述（可选）"},null,40,Qe),[[f,d.desc]])]),e("td",null,[w(e("input",{"onUpdate:modelValue":_=>d.order=_,type:"number",onBlur:_=>o(d),class:"table-input order-input"},null,40,We),[[f,d.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:_=>i(d.id),title:"删除"},m[8]||(m[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,Xe)])]))),128))])])])]))}},Ze=I(Ye,[["__scopeId","data-v-2003d901"]]),et={class:"ad-manage"},tt={class:"ad-header"},lt={class:"ad-section"},nt={class:"ad-card"},st={class:"ad-table"},ot=["onUpdate:modelValue","onBlur"],at=["onUpdate:modelValue","onBlur"],it=["onClick"],dt={class:"ad-section"},ut={class:"ad-card"},rt={class:"ad-table"},ct=["onUpdate:modelValue","onBlur"],vt=["onUpdate:modelValue","onBlur"],pt=["onClick"],mt={__name:"AdManage",setup(z){const s=h([]),c=h([]),u=h(""),a=h(""),b=h("left");L($);async function $(){const v=await te();s.value=v.data.filter(t=>t.position==="left"),c.value=v.data.filter(t=>t.position==="right")}async function y(){!u.value||!a.value||(await le({position:b.value,img:u.value,url:a.value}),u.value="",a.value="",b.value="left",$())}async function M(v){await ne(v.id,{img:v.img,url:v.url}),$()}async function k(v){await se(v),$()}return(v,t)=>(r(),g("div",et,[e("div",tt,[e("form",{class:"ad-add-row",onSubmit:E(y,["prevent"])},[w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>u.value=l),placeholder:"广告图片链接",class:"input"},null,512),[[f,u.value]]),w(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>a.value=l),placeholder:"广告跳转链接",class:"input"},null,512),[[f,a.value]]),w(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>b.value=l),class:"input select-input"},t[3]||(t[3]=[e("option",{value:"left"},"左侧广告",-1),e("option",{value:"right"},"右侧广告",-1)]),512),[[H,b.value]]),t[4]||(t[4]=e("button",{class:"btn",type:"submit"},"添加广告",-1))],32)]),e("div",lt,[t[6]||(t[6]=e("h3",{class:"section-title"},"左侧广告列表",-1)),e("div",nt,[e("table",st,[t[5]||(t[5]=e("thead",null,[e("tr",null,[e("th",null,"图片"),e("th",null,"跳转链接"),e("th",null,"操作")])],-1)),e("tbody",null,[(r(!0),g(A,null,S(s.value,l=>(r(),g("tr",{key:l.id},[e("td",null,[w(e("input",{"onUpdate:modelValue":o=>l.img=o,onBlur:o=>M(l),class:"input"},null,40,ot),[[f,l.img]])]),e("td",null,[w(e("input",{"onUpdate:modelValue":o=>l.url=o,onBlur:o=>M(l),class:"input"},null,40,at),[[f,l.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:o=>k(l.id)},"删除广告",8,it)])]))),128))])])])]),e("div",dt,[t[8]||(t[8]=e("h3",{class:"section-title"},"右侧广告列表",-1)),e("div",ut,[e("table",rt,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"图片"),e("th",null,"跳转链接"),e("th",null,"操作")])],-1)),e("tbody",null,[(r(!0),g(A,null,S(c.value,l=>(r(),g("tr",{key:l.id},[e("td",null,[w(e("input",{"onUpdate:modelValue":o=>l.img=o,onBlur:o=>M(l),class:"input"},null,40,ct),[[f,l.img]])]),e("td",null,[w(e("input",{"onUpdate:modelValue":o=>l.url=o,onBlur:o=>M(l),class:"input"},null,40,vt),[[f,l.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:o=>k(l.id)},"删除广告",8,pt)])]))),128))])])])])]))}},ht=I(mt,[["__scopeId","data-v-780b5e23"]]),gt={class:"friend-manage"},bt={class:"friend-add"},wt={class:"friend-card"},kt={class:"friend-table"},_t=["onUpdate:modelValue","onBlur"],ft=["onUpdate:modelValue","onBlur"],$t=["onUpdate:modelValue","onBlur"],yt=["onClick"],Mt={__name:"FriendLinkManage",setup(z){const s=h([]),c=h(""),u=h(""),a=h("");L(b);async function b(){const k=await oe();s.value=k.data}async function $(){!c.value||!u.value||(await ae({title:c.value,url:u.value,logo:a.value}),c.value="",u.value="",a.value="",b())}async function y(k){await ie(k.id,{title:k.title,url:k.url,logo:k.logo}),b()}async function M(k){await de(k),b()}return(k,v)=>(r(),g("div",gt,[v[4]||(v[4]=e("div",{class:"friend-header"},null,-1)),e("div",bt,[w(e("input",{"onUpdate:modelValue":v[0]||(v[0]=t=>c.value=t),placeholder:"网站名",class:"input"},null,512),[[f,c.value]]),w(e("input",{"onUpdate:modelValue":v[1]||(v[1]=t=>u.value=t),placeholder:"网站链接",class:"input"},null,512),[[f,u.value]]),w(e("input",{"onUpdate:modelValue":v[2]||(v[2]=t=>a.value=t),placeholder:"logo链接(可选)",class:"input"},null,512),[[f,a.value]]),e("button",{class:"btn",onClick:$},"添加友链")]),e("div",wt,[e("table",kt,[v[3]||(v[3]=e("thead",null,[e("tr",null,[e("th",null,"网站名"),e("th",null,"链接"),e("th",null,"Logo"),e("th",null,"操作")])],-1)),e("tbody",null,[(r(!0),g(A,null,S(s.value,t=>(r(),g("tr",{key:t.id},[e("td",null,[w(e("input",{"onUpdate:modelValue":l=>t.title=l,onBlur:l=>y(t),class:"input"},null,40,_t),[[f,t.title]])]),e("td",null,[w(e("input",{"onUpdate:modelValue":l=>t.url=l,onBlur:l=>y(t),class:"input"},null,40,ft),[[f,t.url]])]),e("td",null,[w(e("input",{"onUpdate:modelValue":l=>t.logo=l,onBlur:l=>y(t),class:"input",placeholder:"logo链接(可选)"},null,40,$t),[[f,t.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>M(t.id)},"删除",8,yt)])]))),128))])])])]))}},Ct=I(Mt,[["__scopeId","data-v-f280329a"]]),Bt={class:"user-manage"},Vt={class:"user-card"},Ut={class:"password-section"},xt={class:"password-form"},At={class:"form-group"},St={class:"form-group"},It={class:"form-group"},Lt={class:"form-actions"},zt=["disabled"],Tt={__name:"UserManage",setup(z){const s=h(""),c=h(""),u=h(""),a=h(!1),b=h(""),$=h("success"),y=h({});L(async()=>{try{const v=await ue();y.value=v.data}catch(v){console.error("获取用户信息失败:",v)}});async function M(){if(!s.value||!c.value||!u.value){k("请填写所有密码字段","error");return}if(c.value!==u.value){k("两次输入的新密码不一致","error");return}if(c.value.length<6){k("新密码长度至少6位","error");return}a.value=!0,b.value="";try{await re(s.value,c.value),k("密码修改成功","success"),s.value="",c.value="",u.value=""}catch(v){k(v.response?.data?.message||"密码修改失败","error")}finally{a.value=!1}}function k(v,t){b.value=v,$.value=t,v==="密码修改成功"&&t==="success"?setTimeout(()=>{b.value="2秒后自动退出登录,请使用新密码重新登录...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{b.value=""},3e3)}return(v,t)=>(r(),g("div",Bt,[t[7]||(t[7]=e("div",{class:"user-header"},null,-1)),e("div",Vt,[e("div",Ut,[t[6]||(t[6]=e("h3",{class:"section-title"},"修改密码",-1)),e("div",xt,[e("div",At,[t[3]||(t[3]=e("label",null,"当前密码：",-1)),w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value=l),type:"password",placeholder:"请输入当前密码",class:"input"},null,512),[[f,s.value]])]),e("div",St,[t[4]||(t[4]=e("label",null,"新密码：",-1)),w(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>c.value=l),type:"password",placeholder:"请输入新密码",class:"input"},null,512),[[f,c.value]])]),e("div",It,[t[5]||(t[5]=e("label",null,"确认新密码：",-1)),w(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>u.value=l),type:"password",placeholder:"请再次输入新密码",class:"input"},null,512),[[f,u.value]])]),e("div",Lt,[e("button",{onClick:M,class:"btn",disabled:a.value},C(a.value?"修改中...":"修改密码"),9,zt)]),b.value?(r(),g("p",{key:0,class:U(["message",$.value])},C(b.value),3)):V("",!0)])])])]))}},Ht=I(Tt,[["__scopeId","data-v-85ce40f4"]]),Ft={class:"backup-manage"},Pt={class:"toolbar"},Nt=["disabled"],jt=["disabled"],Dt={class:"backup-list"},Et={key:0,class:"empty-state"},Ot={key:1,class:"backup-grid"},qt={class:"backup-info"},Kt={class:"backup-name"},Rt={class:"backup-meta"},Gt={class:"backup-size"},Jt={class:"backup-date"},Qt={class:"backup-actions"},Wt=["onClick"],Xt=["onClick"],Yt=["onClick"],Zt={key:1,class:"modal-overlay"},el={class:"modal-content"},tl={class:"modal-actions"},ll={__name:"BackupManage",setup(z){const s=h([]),c=P({create:!1,list:!1,delete:!1,restore:!1}),u=h({text:"",type:""}),a=P({show:!1,filename:"",action:null,title:"",confirmClass:""}),b=localStorage.getItem("token");async function $(i,n={}){return(await fetch(i,{...n,headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json",...n.headers}})).json()}const y=(i,n="success")=>{u.value={text:i,type:n},setTimeout(()=>{u.value={text:"",type:""}},3e3)},M=async()=>{c.create=!0;const i=await $("/api/backup/create",{method:"POST"});i.success?(y("备份创建成功！"),await k()):y(i.message||"备份创建失败","error"),c.create=!1},k=async()=>{c.list=!0;const i=await $("/api/backup/list");i.success?s.value=i.backups:y("获取备份列表失败","error"),c.list=!1},v=i=>{window.open(`/api/backup/download/${i}?token=${b}`,"_blank")},t=(i,n)=>{a.show=!0,a.filename=n,a.action=i,a.title=i==="delete"?"删除":"恢复",a.confirmClass=i==="delete"?"btn-danger":"btn-restore"},l=async()=>{const{action:i,filename:n}=a;a.show=!1,c[i]=!0;let m;i==="delete"?m=await $(`/api/backup/delete/${n}`,{method:"DELETE"}):i==="restore"&&(m=await $(`/api/backup/restore/${n}`,{method:"POST"})),m.success?(y(`${a.title}成功！`),await k()):y(m.message||`${a.title}失败`,"error"),c[i]=!1},o=i=>i?new Date(i).toLocaleString("zh-CN",{hour12:!1}):"--";return L(()=>{k()}),(i,n)=>(r(),g("div",Ft,[e("div",Pt,[e("button",{class:"btn btn-primary",onClick:M,disabled:c.create},[n[1]||(n[1]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),x(" "+C(c.create?"备份中...":"创建备份"),1)],8,Nt),e("button",{class:"btn btn-secondary",onClick:k,disabled:c.list},[n[2]||(n[2]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),x(" "+C(c.list?"刷新中...":"刷新列表"),1)],8,jt)]),u.value.text?(r(),g("div",{key:0,class:U(["message",u.value.type])},C(u.value.text),3)):V("",!0),e("div",Dt,[s.value.length===0&&!c.list?(r(),g("div",Et,n[3]||(n[3]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"暂无备份文件",-1)]))):(r(),g("div",Ot,[(r(!0),g(A,null,S(s.value,m=>(r(),g("div",{key:m.name,class:"backup-card"},[n[7]||(n[7]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",qt,[e("div",Kt,C(m.name),1),e("div",Rt,[e("span",Gt,C(m.size),1),e("span",Jt,C(o(m.created)),1)])]),e("div",Qt,[e("button",{class:"btn-icon btn-restore",onClick:d=>t("restore",m.name),title:"恢复备份"},n[4]||(n[4]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)]),8,Wt),e("button",{class:"btn-icon",onClick:d=>v(m.name),title:"下载备份"},n[5]||(n[5]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)]),8,Xt),e("button",{class:"btn-icon btn-danger",onClick:d=>t("delete",m.name),title:"删除备份"},n[6]||(n[6]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)]),8,Yt)])]))),128))]))]),a.show?(r(),g("div",Zt,[e("div",el,[e("h3",null,"确认"+C(a.title),1),e("p",null,[x("确定要"+C(a.title)+"备份文件 ",1),e("strong",null,C(a.filename),1),n[8]||(n[8]=x(" 吗？"))]),e("div",tl,[e("button",{class:"btn btn-secondary",onClick:n[0]||(n[0]=m=>a.show=!1)},"取消"),e("button",{class:U(["btn",a.confirmClass]),onClick:l},"确认",2)])])])):V("",!0)]))}},nl=I(ll,[["__scopeId","data-v-ed242e45"]]),sl={key:0,class:"login-container"},ol={class:"login-card"},al={class:"login-form"},il={class:"password-input-wrapper"},dl=["type"],ul={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},rl={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},cl={class:"login-buttons"},vl=["disabled"],pl={key:0,class:"login-error"},ml={key:1,class:"admin-layout"},hl={class:"menu-list"},gl={class:"admin-main"},bl={class:"admin-header"},wl={class:"header-title"},kl={class:"admin-content"},_l={key:0,class:"welcome-page"},fl={class:"welcome-cards"},$l={class:"welcome-card"},yl={class:"welcome-value"},Ml={class:"welcome-card"},Cl={class:"welcome-value"},Bl={__name:"Admin",setup(z){const s=h("welcome"),c=h(""),u=h(""),a=h(!1),b=h(""),$=h(""),y=h(!1),M=h(""),k=h(!1),v=h(!1),t=D(()=>{switch(s.value){case"menu":return"栏目管理";case"card":return"卡片管理";case"ad":return"广告管理";case"friend":return"友链管理";case"user":return"用户管理";case"backup":return"备份管理";default:return""}});L(()=>{const _=localStorage.getItem("token");a.value=!!_,a.value&&l()});async function l(){try{const _=await fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(_.ok){const p=await _.json();c.value=p.last_login_time||"",u.value=p.last_login_ip||""}}catch(_){console.error("获取用户信息失败:",_)}}async function o(){if(!b.value||!$.value){M.value="请输入用户名和密码";return}y.value=!0,M.value="";try{const _=await ce(b.value,$.value);_.data.token&&(localStorage.setItem("token",_.data.token),a.value=!0,c.value=_.data.lastLoginTime||"",u.value=_.data.lastLoginIp||"")}catch(_){M.value=_.response?.data?.message||"登录失败，请检查用户名和密码"}finally{y.value=!1}}function i(){localStorage.removeItem("token"),a.value=!1,b.value="",$.value="",M.value=""}function n(){window.open("/","_blank")}function m(){v.value=!v.value}function d(){v.value=!1}return(_,p)=>a.value?(r(),g("div",ml,[e("aside",{class:U(["admin-sider",{open:v.value}]),onClick:E(d,["self"])},[e("div",{class:"logo clickable",onClick:p[3]||(p[3]=B=>{s.value="welcome",d()})},"Admin"),e("ul",hl,[e("li",{class:U({active:s.value==="menu"}),onClick:p[4]||(p[4]=B=>{s.value="menu",d()})},"栏目管理",2),e("li",{class:U({active:s.value==="card"}),onClick:p[5]||(p[5]=B=>{s.value="card",d()})},"卡片管理",2),e("li",{class:U({active:s.value==="ad"}),onClick:p[6]||(p[6]=B=>{s.value="ad",d()})},"广告管理",2),e("li",{class:U({active:s.value==="friend"}),onClick:p[7]||(p[7]=B=>{s.value="friend",d()})},"友链管理",2),e("li",{class:U({active:s.value==="user"}),onClick:p[8]||(p[8]=B=>{s.value="user",d()})},"用户管理",2),e("li",{class:U({active:s.value==="backup"}),onClick:p[9]||(p[9]=B=>{s.value="backup",d()})},"备份管理",2)])],2),e("main",gl,[e("div",bl,[e("button",{class:"menu-toggle",onClick:m}," ☰ "),e("div",wl,C(t.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:n,title:"进入主页"},p[14]||(p[14]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),e("button",{class:"btn logout-btn",onClick:i},"退出登录")])]),e("div",kl,[s.value==="welcome"?(r(),g("div",_l,[p[17]||(p[17]=e("h2",{class:"welcome-title"},"欢迎您进入 Con-Nav-Item 后台管理系统",-1)),e("div",fl,[e("div",$l,[p[15]||(p[15]=j('<div class="welcome-icon time-icon" data-v-3d6ed9cb><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-3d6ed9cb><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-3d6ed9cb></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-3d6ed9cb></path></svg></div><div class="welcome-label" data-v-3d6ed9cb>上次登录时间</div>',2)),e("div",yl,C(c.value||"--"),1)]),e("div",Ml,[p[16]||(p[16]=j('<div class="welcome-icon ip-icon" data-v-3d6ed9cb><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-3d6ed9cb><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-3d6ed9cb></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-3d6ed9cb></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-3d6ed9cb></circle></svg></div><div class="welcome-label" data-v-3d6ed9cb>上次登录IP</div>',2)),e("div",Cl,C(u.value||"--"),1)])])])):V("",!0),s.value==="menu"?(r(),T(Pe,{key:1})):V("",!0),s.value==="card"?(r(),T(Ze,{key:2})):V("",!0),s.value==="ad"?(r(),T(ht,{key:3})):V("",!0),s.value==="friend"?(r(),T(Ct,{key:4})):V("",!0),s.value==="user"?(r(),T(Ht,{key:5})):V("",!0),s.value==="backup"?(r(),T(nl,{key:6})):V("",!0)]),p[18]||(p[18]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[x("Copyright © 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(r(),g("div",sl,[e("div",ol,[p[13]||(p[13]=e("h2",{class:"login-title"},"后台管理登录",-1)),e("div",al,[w(e("input",{"onUpdate:modelValue":p[0]||(p[0]=B=>b.value=B),type:"text",placeholder:"用户名",class:"login-input",onKeyup:N(o,["enter"])},null,544),[[f,b.value]]),e("div",il,[w(e("input",{"onUpdate:modelValue":p[1]||(p[1]=B=>$.value=B),type:k.value?"text":"password",placeholder:"密码",class:"login-input password-input",onKeyup:N(o,["enter"])},null,40,dl),[[q,$.value]]),e("span",{class:"toggle-password",onClick:p[2]||(p[2]=B=>k.value=!k.value)},[k.value?(r(),g("svg",ul,p[10]||(p[10]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)]))):(r(),g("svg",rl,p[11]||(p[11]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])))])]),e("div",cl,[e("button",{onClick:n,class:"back-btn"},p[12]||(p[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),x(" 返回首页 ")])),e("button",{onClick:o,class:"login-btn",disabled:y.value},C(y.value?"登录中...":"登录"),9,vl)]),M.value?(r(),g("p",pl,C(M.value),1)):V("",!0)])])]))}},xl=I(Bl,[["__scopeId","data-v-3d6ed9cb"]]);export{xl as default};
