var Q=Object.defineProperty,R=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var j=(B,s,o)=>s in B?Q(B,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):B[s]=o,D=(B,s)=>{for(var o in s||(s={}))X.call(s,o)&&j(B,o,s[o]);if(P)for(var o of P(s))Y.call(s,o)&&j(B,o,s[o]);return B},N=(B,s)=>R(B,W(s));var y=(B,s,o)=>new Promise((i,r)=>{var h=b=>{try{M(o.next(b))}catch(_){r(_)}},k=b=>{try{M(o.throw(b))}catch(_){r(_)}},M=b=>b.done?i(b.value):Promise.resolve(b.value).then(h,k);M((o=o.apply(B,s)).next())});import{_ as L,r as m,g as T,c as w,o as c,b as e,w as f,v as $,q as A,F as I,a as z,n as S,t as U,e as q,y as E,z as F,j as G,d as x,l as O,A as Z,B as H,C as K}from"./index-D2wbntDN.js";import{g as J,n as ee,o as te,q as ne,r as le,s as se,t as oe,v as ae,u as ie,k as ue,d as de,a as re,w as ce,x as ve,y as pe,b as me,z as he,A as ge,B as we,C as ke,D as be,l as _e}from"./api-DJSardu8.js";const fe={class:"menu-manage"},$e={class:"menu-header"},ye={class:"menu-add"},Me={class:"menu-content"},Ce={class:"menu-list"},Be={class:"main-menu"},Ve={class:"menu-info"},Ue=["onUpdate:modelValue","onBlur"],xe={class:"menu-order"},Se=["onUpdate:modelValue","onBlur"],Ae={class:"menu-actions"},Ie=["onClick","title"],ze=["onClick"],Le={class:"sub-menu-header"},Te={class:"sub-menu-title"},He=["onClick"],Fe={key:0,class:"sub-menu-list"},Pe={class:"sub-menu-info"},je=["onUpdate:modelValue","onBlur"],De={class:"sub-menu-order"},Ne=["onUpdate:modelValue","onBlur"],Ee={class:"sub-menu-actions"},Oe=["onClick"],Ke={key:1,class:"empty-sub-menu"},qe=["onClick"],Ge={__name:"MenuManage",setup(B){const s=m([]),o=m("");T(i);function i(){return y(this,null,function*(){const t=yield J();s.value=t.data.map(n=>N(D({},n),{showSubMenu:!1}))})}function r(){return y(this,null,function*(){if(!o.value.trim())return;const t=s.value.length?Math.max(...s.value.map(n=>n.order||0)):0;yield ee({name:o.value.trim(),order:t+1}),o.value="",i()})}function h(t){return y(this,null,function*(){yield te(t.id,{name:t.name,order:t.order}),i()})}function k(t){return y(this,null,function*(){confirm("确定要删除这个主菜单吗？删除后将同时删除其下的所有子菜单和卡片。")&&(yield ne(t),i())})}function M(t){return y(this,null,function*(){var a;const n=s.value.find(g=>g.id===t),l=prompt("请输入子菜单名称：");if(!(l!=null&&l.trim()))return;const p=(a=n.subMenus)!=null&&a.length?Math.max(...n.subMenus.map(g=>g.order||0)):0;yield le(t,{name:l.trim(),order:p+1}),i()})}function b(t){return y(this,null,function*(){yield se(t.id,{name:t.name,order:t.order}),i()})}function _(t){return y(this,null,function*(){confirm("确定要删除这个子菜单吗？删除后将同时删除其下的所有卡片。")&&(yield oe(t),i())})}function v(t){const n=s.value.find(l=>l.id===t);n&&(n.showSubMenu=!n.showSubMenu)}return(t,n)=>(c(),w("div",fe,[e("div",$e,[n[2]||(n[2]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"管理主菜单和子菜单")],-1)),e("div",ye,[f(e("input",{"onUpdate:modelValue":n[0]||(n[0]=l=>o.value=l),placeholder:"请输入主菜单名称",class:"input"},null,512),[[$,o.value]]),e("button",{class:"btn btn-primary",onClick:r},n[1]||(n[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),A(" 添加主菜单 ")]))])]),e("div",Me,[e("div",Ce,[(c(!0),w(I,null,z(s.value,l=>{var p;return c(),w("div",{key:l.id,class:"menu-item"},[e("div",Be,[e("div",Ve,[n[4]||(n[4]=e("div",{class:"menu-icon"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 3h18v18H3zM9 9h6v6H9z"})])],-1)),f(e("input",{"onUpdate:modelValue":a=>l.name=a,onBlur:a=>h(l),class:"menu-name-input"},null,40,Ue),[[$,l.name]]),e("div",xe,[n[3]||(n[3]=e("span",{class:"order-label"},"排序",-1)),f(e("input",{"onUpdate:modelValue":a=>l.order=a,type:"number",onBlur:a=>h(l),class:"order-input"},null,40,Se),[[$,l.order,void 0,{number:!0}]])])]),e("div",Ae,[e("button",{class:"btn btn-icon expand-btn",onClick:a=>v(l.id),title:l.showSubMenu?"收起子菜单":"展开子菜单"},n[5]||(n[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"m6 9 6 6 6-6"})],-1)]),8,Ie),e("button",{class:"btn btn-danger btn-icon",onClick:a=>k(l.id),title:"删除主菜单"},n[6]||(n[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,ze)])]),e("div",{class:S(["sub-menu-section",{expanded:l.showSubMenu}])},[e("div",Le,[e("div",Te,[n[7]||(n[7]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 11H1l8-8 8 8h-8v8z"})],-1)),A(" 子菜单 ("+U(((p=l.subMenus)==null?void 0:p.length)||0)+") ",1)]),e("button",{class:"btn btn-sm btn-outline",onClick:a=>M(l.id)},n[8]||(n[8]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),A(" 添加子菜单 ")]),8,He)]),l.subMenus&&l.subMenus.length>0?(c(),w("div",Fe,[(c(!0),w(I,null,z(l.subMenus,a=>(c(),w("div",{key:a.id,class:"sub-menu-item"},[e("div",Pe,[n[9]||(n[9]=e("div",{class:"sub-menu-icon"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 6h16M4 12h16M4 18h16"})])],-1)),f(e("input",{"onUpdate:modelValue":g=>a.name=g,onBlur:g=>b(a),class:"sub-menu-name-input"},null,40,je),[[$,a.name]]),e("div",De,[f(e("input",{"onUpdate:modelValue":g=>a.order=g,type:"number",onBlur:g=>b(a),class:"order-input"},null,40,Ne),[[$,a.order,void 0,{number:!0}]])])]),e("div",Ee,[e("button",{class:"btn btn-danger btn-icon btn-sm",onClick:g=>_(a.id),title:"删除子菜单"},n[10]||(n[10]=[e("svg",{width:"14",height:"14",viewBox:"0 0 22 22",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,Oe)])]))),128))])):(c(),w("div",Ke,[n[11]||(n[11]=e("p",null,"暂无子菜单",-1)),e("button",{class:"btn btn-sm btn-outline",onClick:a=>M(l.id)},"添加第一个子菜单",8,qe)]))],2)])}),128))])])]))}},Je=L(Ge,[["__scopeId","data-v-5964fa59"]]),Qe={class:"card-manage"},Re={class:"card-header"},We={class:"card-add"},Xe=["value"],Ye=["value"],Ze={class:"card-card"},et={class:"card-table"},tt=["onUpdate:modelValue","onBlur"],nt=["onUpdate:modelValue","onBlur"],lt=["onUpdate:modelValue","onBlur"],st=["onUpdate:modelValue","onBlur"],ot=["onUpdate:modelValue","onBlur"],at=["onClick"],it={__name:"CardManage",setup(B){const s=m([]),o=m([]),i=m(),r=m(""),h=m(""),k=m(""),M=m(""),b=q(()=>{if(!i.value)return[];const a=s.value.find(g=>g.id===i.value);return(a==null?void 0:a.subMenus)||[]});T(()=>y(null,null,function*(){const a=yield J();s.value=a.data,s.value.length&&(i.value=s.value[0].id,r.value="")})),E(i,()=>{r.value="",t()}),E(r,t);function _(){r.value=""}function v(){t()}function t(){return y(this,null,function*(){if(!i.value)return;const a=yield de(i.value,r.value||null);o.value=a.data})}function n(){return y(this,null,function*(){!h.value||!k.value||(yield ae({menu_id:i.value,sub_menu_id:r.value||null,title:h.value,url:k.value,logo_url:M.value}),h.value="",k.value="",M.value="",t())})}function l(a){return y(this,null,function*(){yield ie(a.id,{menu_id:i.value,sub_menu_id:r.value||null,title:a.title,url:a.url,logo_url:a.logo_url,desc:a.desc,order:a.order}),t()})}function p(a){return y(this,null,function*(){yield ue(a),t()})}return(a,g)=>(c(),w("div",Qe,[e("div",Re,[g[7]||(g[7]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"管理网站导航卡片，支持主菜单和子菜单分类")],-1)),e("div",We,[f(e("select",{"onUpdate:modelValue":g[0]||(g[0]=u=>i.value=u),class:"input narrow",onChange:_},[(c(!0),w(I,null,z(s.value,u=>(c(),w("option",{value:u.id,key:u.id},U(u.name),9,Xe))),128))],544),[[F,i.value]]),f(e("select",{"onUpdate:modelValue":g[1]||(g[1]=u=>r.value=u),class:"input narrow",onChange:v},[g[5]||(g[5]=e("option",{value:""},"主菜单",-1)),(c(!0),w(I,null,z(b.value,u=>(c(),w("option",{value:u.id,key:u.id},U(u.name),9,Ye))),128))],544),[[F,r.value]]),f(e("input",{"onUpdate:modelValue":g[2]||(g[2]=u=>h.value=u),placeholder:"卡片标题",class:"input narrow"},null,512),[[$,h.value]]),f(e("input",{"onUpdate:modelValue":g[3]||(g[3]=u=>k.value=u),placeholder:"卡片链接",class:"input wide"},null,512),[[$,k.value]]),f(e("input",{"onUpdate:modelValue":g[4]||(g[4]=u=>M.value=u),placeholder:"logo链接(可选)",class:"input wide"},null,512),[[$,M.value]]),e("button",{class:"btn",onClick:n},g[6]||(g[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),A(" 添加卡片 ")]))])]),e("div",Ze,[e("table",et,[g[9]||(g[9]=e("thead",null,[e("tr",null,[e("th",null,"标题"),e("th",null,"网址"),e("th",null,"Logo链接"),e("th",null,"描述"),e("th",null,"排序"),e("th",null,"操作")])],-1)),e("tbody",null,[(c(!0),w(I,null,z(o.value,u=>(c(),w("tr",{key:u.id},[e("td",null,[f(e("input",{"onUpdate:modelValue":C=>u.title=C,onBlur:C=>l(u),class:"table-input"},null,40,tt),[[$,u.title]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":C=>u.url=C,onBlur:C=>l(u),class:"table-input"},null,40,nt),[[$,u.url]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":C=>u.logo_url=C,onBlur:C=>l(u),class:"table-input",placeholder:"logo链接(可选)"},null,40,lt),[[$,u.logo_url]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":C=>u.desc=C,onBlur:C=>l(u),class:"table-input",placeholder:"描述（可选）"},null,40,st),[[$,u.desc]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":C=>u.order=C,type:"number",onBlur:C=>l(u),class:"table-input order-input"},null,40,ot),[[$,u.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:C=>p(u.id),title:"删除"},g[8]||(g[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,at)])]))),128))])])])]))}},ut=L(it,[["__scopeId","data-v-2003d901"]]),dt={class:"ad-manage"},rt={class:"ad-header"},ct={class:"ad-section"},vt={class:"ad-card"},pt={class:"ad-table"},mt=["onUpdate:modelValue","onBlur"],ht=["onUpdate:modelValue","onBlur"],gt=["onClick"],wt={class:"ad-section"},kt={class:"ad-card"},bt={class:"ad-table"},_t=["onUpdate:modelValue","onBlur"],ft=["onUpdate:modelValue","onBlur"],$t=["onClick"],yt={__name:"AdManage",setup(B){const s=m([]),o=m([]),i=m(""),r=m(""),h=m("left");T(k);function k(){return y(this,null,function*(){const v=yield re();s.value=v.data.filter(t=>t.position==="left"),o.value=v.data.filter(t=>t.position==="right")})}function M(){return y(this,null,function*(){!i.value||!r.value||(yield ce({position:h.value,img:i.value,url:r.value}),i.value="",r.value="",h.value="left",k())})}function b(v){return y(this,null,function*(){yield ve(v.id,{img:v.img,url:v.url}),k()})}function _(v){return y(this,null,function*(){yield pe(v),k()})}return(v,t)=>(c(),w("div",dt,[e("div",rt,[e("form",{class:"ad-add-row",onSubmit:G(M,["prevent"])},[f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>i.value=n),placeholder:"广告图片链接",class:"input"},null,512),[[$,i.value]]),f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>r.value=n),placeholder:"广告跳转链接",class:"input"},null,512),[[$,r.value]]),f(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>h.value=n),class:"input select-input"},t[3]||(t[3]=[e("option",{value:"left"},"左侧广告",-1),e("option",{value:"right"},"右侧广告",-1)]),512),[[F,h.value]]),t[4]||(t[4]=e("button",{class:"btn",type:"submit"},"添加广告",-1))],32)]),e("div",ct,[t[6]||(t[6]=e("h3",{class:"section-title"},"左侧广告列表",-1)),e("div",vt,[e("table",pt,[t[5]||(t[5]=e("thead",null,[e("tr",null,[e("th",null,"图片"),e("th",null,"跳转链接"),e("th",null,"操作")])],-1)),e("tbody",null,[(c(!0),w(I,null,z(s.value,n=>(c(),w("tr",{key:n.id},[e("td",null,[f(e("input",{"onUpdate:modelValue":l=>n.img=l,onBlur:l=>b(n),class:"input"},null,40,mt),[[$,n.img]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":l=>n.url=l,onBlur:l=>b(n),class:"input"},null,40,ht),[[$,n.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>_(n.id)},"删除广告",8,gt)])]))),128))])])])]),e("div",wt,[t[8]||(t[8]=e("h3",{class:"section-title"},"右侧广告列表",-1)),e("div",kt,[e("table",bt,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"图片"),e("th",null,"跳转链接"),e("th",null,"操作")])],-1)),e("tbody",null,[(c(!0),w(I,null,z(o.value,n=>(c(),w("tr",{key:n.id},[e("td",null,[f(e("input",{"onUpdate:modelValue":l=>n.img=l,onBlur:l=>b(n),class:"input"},null,40,_t),[[$,n.img]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":l=>n.url=l,onBlur:l=>b(n),class:"input"},null,40,ft),[[$,n.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>_(n.id)},"删除广告",8,$t)])]))),128))])])])])]))}},Mt=L(yt,[["__scopeId","data-v-780b5e23"]]),Ct={class:"friend-manage"},Bt={class:"friend-add"},Vt={class:"friend-card"},Ut={class:"friend-table"},xt=["onUpdate:modelValue","onBlur"],St=["onUpdate:modelValue","onBlur"],At=["onUpdate:modelValue","onBlur"],It=["onClick"],zt={__name:"FriendLinkManage",setup(B){const s=m([]),o=m(""),i=m(""),r=m("");T(h);function h(){return y(this,null,function*(){const _=yield me();s.value=_.data})}function k(){return y(this,null,function*(){!o.value||!i.value||(yield he({title:o.value,url:i.value,logo:r.value}),o.value="",i.value="",r.value="",h())})}function M(_){return y(this,null,function*(){yield ge(_.id,{title:_.title,url:_.url,logo:_.logo}),h()})}function b(_){return y(this,null,function*(){yield we(_),h()})}return(_,v)=>(c(),w("div",Ct,[v[4]||(v[4]=e("div",{class:"friend-header"},null,-1)),e("div",Bt,[f(e("input",{"onUpdate:modelValue":v[0]||(v[0]=t=>o.value=t),placeholder:"网站名",class:"input"},null,512),[[$,o.value]]),f(e("input",{"onUpdate:modelValue":v[1]||(v[1]=t=>i.value=t),placeholder:"网站链接",class:"input"},null,512),[[$,i.value]]),f(e("input",{"onUpdate:modelValue":v[2]||(v[2]=t=>r.value=t),placeholder:"logo链接(可选)",class:"input"},null,512),[[$,r.value]]),e("button",{class:"btn",onClick:k},"添加友链")]),e("div",Vt,[e("table",Ut,[v[3]||(v[3]=e("thead",null,[e("tr",null,[e("th",null,"网站名"),e("th",null,"链接"),e("th",null,"Logo"),e("th",null,"操作")])],-1)),e("tbody",null,[(c(!0),w(I,null,z(s.value,t=>(c(),w("tr",{key:t.id},[e("td",null,[f(e("input",{"onUpdate:modelValue":n=>t.title=n,onBlur:n=>M(t),class:"input"},null,40,xt),[[$,t.title]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":n=>t.url=n,onBlur:n=>M(t),class:"input"},null,40,St),[[$,t.url]])]),e("td",null,[f(e("input",{"onUpdate:modelValue":n=>t.logo=n,onBlur:n=>M(t),class:"input",placeholder:"logo链接(可选)"},null,40,At),[[$,t.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:n=>b(t.id)},"删除",8,It)])]))),128))])])])]))}},Lt=L(zt,[["__scopeId","data-v-f280329a"]]),Tt={class:"user-manage"},Ht={class:"user-card"},Ft={class:"password-section"},Pt={class:"password-form"},jt={class:"form-group"},Dt={class:"form-group"},Nt={class:"form-group"},Et={class:"form-actions"},Ot=["disabled"],Kt={__name:"UserManage",setup(B){const s=m(""),o=m(""),i=m(""),r=m(!1),h=m(""),k=m("success"),M=m({});T(()=>y(null,null,function*(){try{const v=yield ke();M.value=v.data}catch(v){console.error("获取用户信息失败:",v)}}));function b(){return y(this,null,function*(){var v,t;if(!s.value||!o.value||!i.value){_("请填写所有密码字段","error");return}if(o.value!==i.value){_("两次输入的新密码不一致","error");return}if(o.value.length<6){_("新密码长度至少6位","error");return}r.value=!0,h.value="";try{yield be(s.value,o.value),_("密码修改成功","success"),s.value="",o.value="",i.value=""}catch(n){_(((t=(v=n.response)==null?void 0:v.data)==null?void 0:t.message)||"密码修改失败","error")}finally{r.value=!1}})}function _(v,t){h.value=v,k.value=t,v==="密码修改成功"&&t==="success"?setTimeout(()=>{h.value="2秒后自动退出登录,请使用新密码重新登录...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{h.value=""},3e3)}return(v,t)=>(c(),w("div",Tt,[t[7]||(t[7]=e("div",{class:"user-header"},null,-1)),e("div",Ht,[e("div",Ft,[t[6]||(t[6]=e("h3",{class:"section-title"},"修改密码",-1)),e("div",Pt,[e("div",jt,[t[3]||(t[3]=e("label",null,"当前密码：",-1)),f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>s.value=n),type:"password",placeholder:"请输入当前密码",class:"input"},null,512),[[$,s.value]])]),e("div",Dt,[t[4]||(t[4]=e("label",null,"新密码：",-1)),f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>o.value=n),type:"password",placeholder:"请输入新密码",class:"input"},null,512),[[$,o.value]])]),e("div",Nt,[t[5]||(t[5]=e("label",null,"确认新密码：",-1)),f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>i.value=n),type:"password",placeholder:"请再次输入新密码",class:"input"},null,512),[[$,i.value]])]),e("div",Et,[e("button",{onClick:b,class:"btn",disabled:r.value},U(r.value?"修改中...":"修改密码"),9,Ot)]),h.value?(c(),w("p",{key:0,class:S(["message",k.value])},U(h.value),3)):x("",!0)])])])]))}},qt=L(Kt,[["__scopeId","data-v-85ce40f4"]]),Gt={class:"backup-manage"},Jt={class:"toolbar"},Qt=["disabled"],Rt={class:"backup-list"},Wt={key:0,class:"empty-state"},Xt={key:1,class:"backup-grid"},Yt={class:"backup-info"},Zt={class:"backup-name"},en={class:"backup-meta"},tn={class:"backup-size"},nn={class:"backup-date"},ln={class:"backup-actions"},sn=["onClick"],on=["onClick"],an={key:1,class:"modal-overlay"},un={class:"modal-content"},dn={class:"modal-actions"},rn={__name:"BackupManage",setup(B){const s=m([]),o=m(!1),i=m({text:"",type:""}),r=m({show:!1,filename:""}),h=localStorage.getItem("token"),k=(l,p="success")=>{i.value={text:l,type:p},setTimeout(()=>{i.value={text:"",type:""}},3e3)},M=()=>y(null,null,function*(){o.value=!0,i.value={text:"",type:""};try{const p=yield(yield fetch("/api/backup/create",{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}})).json();p.success?(k("备份创建成功！","success"),yield b()):k(p.message||"备份创建失败","error")}catch(l){console.error("创建备份失败:",l),k("备份创建失败："+l.message,"error")}finally{o.value=!1}}),b=()=>y(null,null,function*(){o.value=!0;try{const p=yield(yield fetch("/api/backup/list",{headers:{Authorization:`Bearer ${h}`}})).json();p.success?s.value=p.backups:k("获取备份列表失败","error")}catch(l){console.error("获取备份列表失败:",l),k("获取备份列表失败："+l.message,"error")}finally{o.value=!1}}),_=l=>{window.open(`/api/backup/download/${l}?token=${h}`,"_blank")},v=l=>{r.value={show:!0,filename:l}},t=()=>y(null,null,function*(){const l=r.value.filename;r.value.show=!1;try{const a=yield(yield fetch(`/api/backup/delete/${l}`,{method:"DELETE",headers:{Authorization:`Bearer ${h}`}})).json();a.success?(k("备份删除成功","success"),yield b()):k(a.message||"备份删除失败","error")}catch(p){console.error("删除备份失败:",p),k("删除备份失败："+p.message,"error")}}),n=l=>new Date(l).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return T(()=>{b()}),(l,p)=>(c(),w("div",Gt,[e("div",Jt,[e("button",{class:"btn btn-primary",onClick:M,disabled:o.value},[p[1]||(p[1]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),A(" "+U(o.value?"备份中...":"创建备份"),1)],8,Qt),e("button",{class:"btn btn-secondary",onClick:b},p[2]||(p[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1),A(" 刷新列表 ")]))]),i.value.text?(c(),w("div",{key:0,class:S(["message",i.value.type])},U(i.value.text),3)):x("",!0),e("div",Rt,[s.value.length===0&&!o.value?(c(),w("div",Wt,p[3]||(p[3]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"暂无备份文件",-1)]))):(c(),w("div",Xt,[(c(!0),w(I,null,z(s.value,a=>(c(),w("div",{key:a.name,class:"backup-card"},[p[6]||(p[6]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",Yt,[e("div",Zt,U(a.name),1),e("div",en,[e("span",tn,U(a.size),1),e("span",nn,U(n(a.created)),1)])]),e("div",ln,[e("button",{class:"btn-icon",onClick:g=>_(a.name),title:"下载备份"},p[4]||(p[4]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)]),8,sn),e("button",{class:"btn-icon btn-danger",onClick:g=>v(a.name),title:"删除备份"},p[5]||(p[5]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)]),8,on)])]))),128))]))]),r.value.show?(c(),w("div",an,[e("div",un,[p[9]||(p[9]=e("h3",null,"确认删除",-1)),e("p",null,[p[7]||(p[7]=A("确定要删除备份文件 ")),e("strong",null,U(r.value.filename),1),p[8]||(p[8]=A(" 吗？"))]),e("div",dn,[e("button",{class:"btn btn-secondary",onClick:p[0]||(p[0]=a=>r.value.show=!1)},"取消"),e("button",{class:"btn btn-danger",onClick:t},"确认删除")])])])):x("",!0)]))}},cn=L(rn,[["__scopeId","data-v-408231af"]]),vn={key:0,class:"login-container"},pn={class:"login-card"},mn={class:"login-form"},hn={class:"password-input-wrapper"},gn=["type"],wn={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},kn={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},bn={class:"login-buttons"},_n=["disabled"],fn={key:0,class:"login-error"},$n={key:1,class:"admin-layout"},yn={class:"menu-list"},Mn={class:"admin-main"},Cn={class:"admin-header"},Bn={class:"header-title"},Vn={class:"admin-content"},Un={key:0,class:"welcome-page"},xn={class:"welcome-cards"},Sn={class:"welcome-card"},An={class:"welcome-value"},In={class:"welcome-card"},zn={class:"welcome-value"},Ln={__name:"Admin",setup(B){const s=m("welcome"),o=m(""),i=m(""),r=m(!1),h=m(""),k=m(""),M=m(!1),b=m(""),_=m(!1),v=m(!1),t=q(()=>{switch(s.value){case"menu":return"栏目管理";case"card":return"卡片管理";case"ad":return"广告管理";case"friend":return"友链管理";case"user":return"用户管理";case"backup":return"备份管理";default:return""}});T(()=>{const C=localStorage.getItem("token");r.value=!!C,r.value&&n()});function n(){return y(this,null,function*(){try{const C=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(C.ok){const d=yield C.json();o.value=d.last_login_time||"",i.value=d.last_login_ip||""}}catch(C){console.error("获取用户信息失败:",C)}})}function l(){return y(this,null,function*(){var C,d;if(!h.value||!k.value){b.value="请输入用户名和密码";return}M.value=!0,b.value="";try{const V=yield _e(h.value,k.value);V.data.token&&(localStorage.setItem("token",V.data.token),r.value=!0,o.value=V.data.lastLoginTime||"",i.value=V.data.lastLoginIp||"")}catch(V){b.value=((d=(C=V.response)==null?void 0:C.data)==null?void 0:d.message)||"登录失败，请检查用户名和密码"}finally{M.value=!1}})}function p(){localStorage.removeItem("token"),r.value=!1,h.value="",k.value="",b.value=""}function a(){window.open("/","_blank")}function g(){v.value=!v.value}function u(){v.value=!1}return(C,d)=>r.value?(c(),w("div",$n,[e("aside",{class:S(["admin-sider",{open:v.value}]),onClick:G(u,["self"])},[e("div",{class:"logo clickable",onClick:d[3]||(d[3]=V=>{s.value="welcome",u()})},"Admin"),e("ul",yn,[e("li",{class:S({active:s.value==="menu"}),onClick:d[4]||(d[4]=V=>{s.value="menu",u()})},"栏目管理",2),e("li",{class:S({active:s.value==="card"}),onClick:d[5]||(d[5]=V=>{s.value="card",u()})},"卡片管理",2),e("li",{class:S({active:s.value==="ad"}),onClick:d[6]||(d[6]=V=>{s.value="ad",u()})},"广告管理",2),e("li",{class:S({active:s.value==="friend"}),onClick:d[7]||(d[7]=V=>{s.value="friend",u()})},"友链管理",2),e("li",{class:S({active:s.value==="user"}),onClick:d[8]||(d[8]=V=>{s.value="user",u()})},"用户管理",2),e("li",{class:S({active:s.value==="backup"}),onClick:d[9]||(d[9]=V=>{s.value="backup",u()})},"备份管理",2)])],2),e("main",Mn,[e("div",Cn,[e("button",{class:"menu-toggle",onClick:g}," ☰ "),e("div",Bn,U(t.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:a,title:"进入主页"},d[14]||(d[14]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),e("button",{class:"btn logout-btn",onClick:p},"退出登录")])]),e("div",Vn,[s.value==="welcome"?(c(),w("div",Un,[d[17]||(d[17]=e("h2",{class:"welcome-title"},"欢迎您进入 Con-Nav-Item 后台管理系统",-1)),e("div",xn,[e("div",Sn,[d[15]||(d[15]=K('<div class="welcome-icon time-icon" data-v-3d6ed9cb><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-3d6ed9cb><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-3d6ed9cb></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-3d6ed9cb></path></svg></div><div class="welcome-label" data-v-3d6ed9cb>上次登录时间</div>',2)),e("div",An,U(o.value||"--"),1)]),e("div",In,[d[16]||(d[16]=K('<div class="welcome-icon ip-icon" data-v-3d6ed9cb><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-3d6ed9cb><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-3d6ed9cb></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-3d6ed9cb></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-3d6ed9cb></circle></svg></div><div class="welcome-label" data-v-3d6ed9cb>上次登录IP</div>',2)),e("div",zn,U(i.value||"--"),1)])])])):x("",!0),s.value==="menu"?(c(),H(Je,{key:1})):x("",!0),s.value==="card"?(c(),H(ut,{key:2})):x("",!0),s.value==="ad"?(c(),H(Mt,{key:3})):x("",!0),s.value==="friend"?(c(),H(Lt,{key:4})):x("",!0),s.value==="user"?(c(),H(qt,{key:5})):x("",!0),s.value==="backup"?(c(),H(cn,{key:6})):x("",!0)]),d[18]||(d[18]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[A("Copyright © 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(c(),w("div",vn,[e("div",pn,[d[13]||(d[13]=e("h2",{class:"login-title"},"后台管理登录",-1)),e("div",mn,[f(e("input",{"onUpdate:modelValue":d[0]||(d[0]=V=>h.value=V),type:"text",placeholder:"用户名",class:"login-input",onKeyup:O(l,["enter"])},null,544),[[$,h.value]]),e("div",hn,[f(e("input",{"onUpdate:modelValue":d[1]||(d[1]=V=>k.value=V),type:_.value?"text":"password",placeholder:"密码",class:"login-input password-input",onKeyup:O(l,["enter"])},null,40,gn),[[Z,k.value]]),e("span",{class:"toggle-password",onClick:d[2]||(d[2]=V=>_.value=!_.value)},[_.value?(c(),w("svg",wn,d[10]||(d[10]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)]))):(c(),w("svg",kn,d[11]||(d[11]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])))])]),e("div",bn,[e("button",{onClick:a,class:"back-btn"},d[12]||(d[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),A(" 返回首页 ")])),e("button",{onClick:l,class:"login-btn",disabled:M.value},U(M.value?"登录中...":"登录"),9,_n)]),b.value?(c(),w("p",fn,U(b.value),1)):x("",!0)])])]))}},Pn=L(Ln,[["__scopeId","data-v-3d6ed9cb"]]);export{Pn as default};
