const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CardGrid-BIuGOsKq.js","assets/index-CguR8SDs.js","assets/CardGrid-fBB6b1za.css"])))=>i.map(i=>d[i]);
var be=Object.defineProperty,ge=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var K=(h,c,d)=>c in h?be(h,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):h[c]=d,j=(h,c)=>{for(var d in c||(c={}))fe.call(c,d)&&K(h,d,c[d]);if(J)for(var d of J(c))me.call(c,d)&&K(h,d,c[d]);return h},Q=(h,c)=>ge(h,ke(c));var y=(h,c,d)=>new Promise((f,p)=>{var $=_=>{try{b(d.next(_))}catch(S){p(S)}},n=_=>{try{b(d.throw(_))}catch(S){p(S)}},b=_=>_.done?f(_.value):Promise.resolve(_.value).then($,n);b((d=d.apply(h,c)).next())});import{_ as le,r as u,c as o,F as B,a as U,o as s,b as t,d as g,t as k,n as N,e as W,f as _e,g as X,w as I,v as V,h as Y,u as we,i as ye,j as Z,k as ee,l as te,m as Ce}from"./index-CguR8SDs.js";import{g as Me,a as Se,b as xe,c as ae,d as Ie,l as $e,e as Be,f as Ue}from"./api-KwLLGkf8.js";const Le={class:"menu-bar"},Ve=["onMouseenter","onMouseleave"],Ae=["onClick"],Ee=["onClick"],ze={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},setup(h){const c=u(null);function d(p){c.value=p}function f(p){setTimeout(()=>{c.value===p&&(c.value=null)},100)}return(p,$)=>(s(),o("nav",Le,[(s(!0),o(B,null,U(h.menus,n=>(s(),o("div",{key:n.id,class:"menu-item",onMouseenter:b=>d(n.id),onMouseleave:b=>f(n.id)},[t("button",{onClick:b=>p.$emit("select",n),class:N({active:n.id===h.activeId})},k(n.name),11,Ae),n.subMenus&&n.subMenus.length>0?(s(),o("div",{key:0,class:N(["sub-menu",{show:c.value===n.id}])},[(s(!0),o(B,null,U(n.subMenus,b=>(s(),o("button",{key:b.id,onClick:_=>p.$emit("select",b,n),class:N([{active:b.id===h.activeSubMenuId},"sub-menu-item"])},k(b.name),11,Ee))),128))],2)):g("",!0)],40,Ve))),128))]))}},Pe=le(ze,[["__scopeId","data-v-16a94230"]]),Re={class:"home-container"},Ne={class:"menu-bar-fixed"},De={class:"search-section"},Te={class:"search-box-wrapper"},qe={class:"search-engine-select"},Fe=["onClick"],Ge={class:"search-container"},Oe=["placeholder"],He={key:0,class:"ad-space-fixed left-ad-fixed"},Je=["href"],Ke=["src"],je={key:1,class:"ad-space-fixed right-ad-fixed"},Qe=["href"],We=["src"],Xe=["disabled"],Ye={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ze={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},et={class:"modal-header"},tt={class:"modal-body"},at={key:0,class:"batch-step"},lt={class:"remember-password-wrapper"},ot={key:0,class:"batch-error"},st={class:"batch-actions"},nt=["disabled"],rt={key:1,class:"batch-step"},it={key:0,class:"batch-error"},dt={class:"batch-actions"},ct=["disabled"],ut={key:2,class:"batch-step"},vt={class:"batch-preview-list"},ht=["onUpdate:modelValue","id"],pt={class:"batch-card-preview"},bt=["src","alt"],gt={class:"batch-card-info"},kt={class:"batch-edit-field"},ft=["onUpdate:modelValue"],mt={class:"batch-edit-field"},_t=["onUpdate:modelValue"],wt={class:"batch-edit-field"},yt=["onUpdate:modelValue"],Ct={class:"batch-card-url"},Mt={key:0,class:"batch-card-warning"},St={key:0,class:"batch-error"},xt={class:"batch-actions"},It=["disabled"],$t={class:"footer"},Bt={class:"footer-content"},Ut={class:"modal-header"},Lt={class:"modal-body"},Vt={class:"friend-links-grid"},At=["href"],Et={class:"friend-link-logo"},zt=["src","alt"],Pt={key:1,class:"friend-link-placeholder"},Rt={class:"friend-link-info"},Nt={__name:"Home",setup(h){const c=ye(()=>Ce(()=>import("./CardGrid-BIuGOsKq.js"),__vite__mapDeps([0,1,2]))),d=u([]),f=u(null),p=u(null),$=u([]),n=u(""),b=u([]),_=u([]),S=u(!1),q=u([]),D=u(!1),w=u(1),C=u(""),A=u(""),m=u(!1),v=u(""),E=u([]),L=u(!1),z=u(!1),F=W(()=>E.value.filter(l=>l.selected).length),G=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:l=>`https://www.google.com/search?q=${encodeURIComponent(l)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:l=>`https://www.baidu.com/s?wd=${encodeURIComponent(l)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:l=>`https://www.bing.com/search?q=${encodeURIComponent(l)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:l=>`https://github.com/search?q=${encodeURIComponent(l)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:l=>`/search?query=${encodeURIComponent(l)}`}],P=u(G[0]);function oe(l){P.value=l}function se(){n.value=""}const ne=W(()=>n.value?$.value.filter(l=>l.title.toLowerCase().includes(n.value.toLowerCase())||l.url.toLowerCase().includes(n.value.toLowerCase())):$.value);_e(()=>y(null,null,function*(){const l=yield Me();d.value=l.data,d.value.length&&(f.value=d.value[0],T());const e=yield Se();b.value=e.data.filter(a=>a.position==="left"),_.value=e.data.filter(a=>a.position==="right");const i=yield xe();q.value=i.data;const r=localStorage.getItem("nav_background");r&&setTimeout(()=>{const a=document.querySelector(".home-container");a&&(a.style.backgroundImage=`url(${r})`,a.style.backgroundSize="cover",a.style.backgroundPosition="center",a.style.backgroundRepeat="no-repeat",a.style.backgroundAttachment="fixed")},0),ce()}));function re(l,e=null){return y(this,null,function*(){e?(f.value=e,p.value=l):(f.value=l,p.value=null),T()})}function T(){return y(this,null,function*(){var e;if(!f.value)return;const l=yield ae(f.value.id,(e=p.value)==null?void 0:e.id);$.value=l.data})}function O(){return y(this,null,function*(){if(n.value.trim())if(P.value.name==="site"){let l=!1;for(const e of d.value){const i=yield ae(e.id),r=i.data.find(a=>a.title.toLowerCase().includes(n.value.toLowerCase())||a.url.toLowerCase().includes(n.value.toLowerCase()));if(r){f.value=e,$.value=i.data,setTimeout(()=>{const a=document.querySelector(`[data-card-id='${r.id}']`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},100),l=!0;break}}l||alert("未找到相关内容")}else{const l=P.value.url(n.value);window.open(l,"_blank")}})}function ie(l){l.target.style.display="none",l.target.nextElementSibling.style.display="flex"}function de(){return y(this,null,function*(){D.value=!0,v.value="";const l=localStorage.getItem("nav_password_token");if(l)try{const{password:e,expiry:i,token:r}=JSON.parse(l);if(Date.now()<i&&r){localStorage.setItem("token",r),C.value=e,L.value=!0,w.value=2;return}else localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}w.value=1})}function R(){D.value=!1,w.value=1,C.value="",A.value="",v.value="",E.value=[],m.value=!1}function ce(){const l=localStorage.getItem("nav_password_token");if(l)try{const{password:e,expiry:i,token:r}=JSON.parse(l);Date.now()<i?(C.value=e,L.value=!0,r&&localStorage.setItem("token",r)):localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}}function H(){return y(this,null,function*(){if(!C.value){v.value="请输入密码";return}m.value=!0,v.value="";try{const l=yield $e("admin",C.value);if(l.data&&l.data.token)localStorage.setItem("token",l.data.token);else throw new Error("登录成功，但未收到 token");if(L.value){const e=Date.now()+72e5;localStorage.setItem("nav_password_token",JSON.stringify({password:C.value,token:l.data.token,expiry:e}))}else localStorage.removeItem("nav_password_token");w.value=2}catch(l){v.value="密码错误，请重试",console.error("密码验证失败:",l)}finally{m.value=!1}})}function ue(){localStorage.removeItem("nav_password_token"),localStorage.removeItem("token"),C.value="",L.value=!1,w.value=1}function ve(){return y(this,null,function*(){var e,i;const l=A.value.split(`
`).map(r=>r.trim()).filter(r=>r.length>0);if(l.length===0){v.value="请输入至少一个网址";return}m.value=!0,v.value="";try{const r=yield Be(l);E.value=r.data.data.map(a=>Q(j({},a),{selected:!0})),w.value=3}catch(r){v.value=((i=(e=r.response)==null?void 0:e.data)==null?void 0:i.error)||"解析失败，请重试"}finally{m.value=!1}})}function he(){return y(this,null,function*(){var e,i,r;const l=E.value.filter(a=>a.selected);if(l.length===0){v.value="请至少选择一个网站";return}m.value=!0,v.value="";try{const a=l.map(x=>({title:x.title,url:x.url,logo:x.logo,description:x.description}));yield Ue(f.value.id,((e=p.value)==null?void 0:e.id)||null,a),alert(`成功添加 ${l.length} 个网站！`),R(),yield T()}catch(a){v.value=((r=(i=a.response)==null?void 0:i.data)==null?void 0:r.error)||"添加失败，请重试"}finally{m.value=!1}})}function pe(){return y(this,null,function*(){if(!z.value){z.value=!0;try{const e=(yield Ie()).data.url,i=document.querySelector(".home-container");i&&(i.style.backgroundImage=`url(${e})`,i.style.backgroundSize="cover",i.style.backgroundPosition="center",i.style.backgroundRepeat="no-repeat",i.style.backgroundAttachment="fixed"),localStorage.setItem("nav_background",e)}catch(l){console.error("获取壁纸失败:",l),alert("获取壁纸失败，请稍后重试")}finally{z.value=!1}}})}return(l,e)=>{var i,r;return s(),o("div",Re,[t("div",Ne,[X(Pe,{menus:d.value,activeId:(i=f.value)==null?void 0:i.id,activeSubMenuId:(r=p.value)==null?void 0:r.id,onSelect:re},null,8,["menus","activeId","activeSubMenuId"])]),t("div",De,[t("div",Te,[t("div",qe,[(s(),o(B,null,U(G,a=>t("button",{key:a.name,class:N(["engine-btn",{active:P.value.name===a.name}]),onClick:x=>oe(a)},k(a.label),11,Fe)),64))]),t("div",Ge,[I(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>n.value=a),type:"text",placeholder:P.value.placeholder,class:"search-input",onKeyup:Y(O,["enter"])},null,40,Oe),[[V,n.value]]),n.value?(s(),o("button",{key:0,class:"clear-btn",onClick:se,"aria-label":"清空",title:"clear"},e[11]||(e[11]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):g("",!0),t("button",{onClick:O,class:"search-btn",title:"search"},e[12]||(e[12]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[t("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])]),b.value.length?(s(),o("div",He,[(s(!0),o(B,null,U(b.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank"},[t("img",{src:a.img,alt:"广告",loading:"lazy"},null,8,Ke)],8,Je))),128))])):g("",!0),_.value.length?(s(),o("div",je,[(s(!0),o(B,null,U(_.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank"},[t("img",{src:a.img,alt:"广告",loading:"lazy"},null,8,We)],8,Qe))),128))])):g("",!0),X(we(c),{cards:ne.value},null,8,["cards"]),f.value?(s(),o("button",{key:2,onClick:de,class:"batch-add-btn",title:"批量添加网站"},e[13]||(e[13]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 5v14M5 12h14"})],-1)]))):g("",!0),t("button",{onClick:pe,class:"change-bg-btn",title:"切换背景",disabled:z.value},[z.value?(s(),o("svg",Ze,e[15]||(e[15]=[t("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"},null,-1)]))):(s(),o("svg",Ye,e[14]||(e[14]=[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},null,-1),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"},null,-1),t("path",{d:"M21 15l-5-5L5 21"},null,-1)])))],8,Xe),D.value?(s(),o("div",{key:3,class:"modal-overlay",onClick:R},[t("div",{class:"modal-content batch-modal",onClick:e[6]||(e[6]=ee(()=>{},["stop"]))},[t("div",et,[t("h3",null,k(w.value===1?"验证密码":w.value===2?"输入网址":"预览并选择"),1),t("button",{onClick:R,class:"close-btn"},e[16]||(e[16]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",tt,[w.value===1?(s(),o("div",at,[e[18]||(e[18]=t("p",{class:"batch-tip"},"请输入管理员密码以继续：",-1)),I(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>C.value=a),type:"password",placeholder:"请输入管理员密码",class:"batch-input",onKeyup:Y(H,["enter"])},null,544),[[V,C.value]]),t("div",lt,[t("label",null,[I(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=a=>L.value=a)},null,512),[[Z,L.value]]),e[17]||(e[17]=t("span",null,"记住密码（2小时）",-1))])]),v.value?(s(),o("p",ot,k(v.value),1)):g("",!0),t("div",st,[t("button",{onClick:R,class:"btn btn-cancel"},"取消"),t("button",{onClick:H,class:"btn btn-primary",disabled:m.value},k(m.value?"验证中...":"确认"),9,nt)])])):g("",!0),w.value===2?(s(),o("div",rt,[e[19]||(e[19]=t("p",{class:"batch-tip"},"请输入需要添加的网址，每行一个：",-1)),I(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>A.value=a),placeholder:`例如：
https://github.com
https://google.com
https://stackoverflow.com`,class:"batch-textarea",rows:"10"},null,512),[[V,A.value]]),v.value?(s(),o("p",it,k(v.value),1)):g("",!0),t("div",dt,[t("button",{onClick:ue,class:"btn btn-cancel"},"上一步"),t("button",{onClick:ve,class:"btn btn-primary",disabled:m.value||!A.value.trim()},k(m.value?"解析中...":"下一步"),9,ct)])])):g("",!0),w.value===3?(s(),o("div",ut,[e[23]||(e[23]=t("p",{class:"batch-tip"},"请选择需要添加的网站：",-1)),t("div",vt,[(s(!0),o(B,null,U(E.value,(a,x)=>(s(),o("div",{key:x,class:"batch-preview-item"},[I(t("input",{type:"checkbox","onUpdate:modelValue":M=>a.selected=M,id:`card-${x}`},null,8,ht),[[Z,a.selected]]),t("div",pt,[t("img",{src:a.logo,alt:a.title,class:"batch-card-logo",onError:e[4]||(e[4]=M=>M.target.src="/default-favicon.png")},null,40,bt),t("div",gt,[t("div",kt,[e[20]||(e[20]=t("label",null,"标题：",-1)),I(t("input",{type:"text","onUpdate:modelValue":M=>a.title=M,class:"batch-edit-input"},null,8,ft),[[V,a.title]])]),t("div",mt,[e[21]||(e[21]=t("label",null,"Logo：",-1)),I(t("input",{type:"text","onUpdate:modelValue":M=>a.logo=M,class:"batch-edit-input"},null,8,_t),[[V,a.logo]])]),t("div",wt,[e[22]||(e[22]=t("label",null,"描述：",-1)),I(t("textarea",{"onUpdate:modelValue":M=>a.description=M,class:"batch-edit-textarea",rows:"2"},null,8,yt),[[V,a.description]])]),t("p",Ct,k(a.url),1),a.success?g("",!0):(s(),o("p",Mt,"⚠️ "+k(a.error),1))])])]))),128))]),v.value?(s(),o("p",St,k(v.value),1)):g("",!0),t("div",xt,[t("button",{onClick:e[5]||(e[5]=a=>w.value=2),class:"btn btn-cancel"},"上一步"),t("button",{onClick:he,class:"btn btn-primary",disabled:m.value||F.value===0},k(m.value?"添加中...":`添加 (${F.value})`),9,It)])])):g("",!0)])])])):g("",!0),t("footer",$t,[t("div",Bt,[t("button",{onClick:e[7]||(e[7]=a=>S.value=!0),class:"friend-link-btn"},e[24]||(e[24]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),t("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),te(" 友情链接 ")])),e[25]||(e[25]=t("p",{class:"copyright"},[te("Copyright © 2025 Nav-Item | "),t("a",{href:"https://github.com/zczy-k/nav-item",target:"_blank",class:"footer-link"},"Powered by zczy-k")],-1))])]),S.value?(s(),o("div",{key:4,class:"modal-overlay",onClick:e[10]||(e[10]=a=>S.value=!1)},[t("div",{class:"modal-content",onClick:e[9]||(e[9]=ee(()=>{},["stop"]))},[t("div",Ut,[e[27]||(e[27]=t("h3",null,"友情链接",-1)),t("button",{onClick:e[8]||(e[8]=a=>S.value=!1),class:"close-btn"},e[26]||(e[26]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",Lt,[t("div",Vt,[(s(!0),o(B,null,U(q.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank",class:"friend-link-card"},[t("div",Et,[a.logo?(s(),o("img",{key:0,src:a.logo,alt:a.title,loading:"lazy",onError:ie},null,40,zt)):(s(),o("div",Pt,k(a.title.charAt(0)),1))]),t("div",Rt,[t("h4",null,k(a.title),1)])],8,At))),128))])])])])):g("",!0)])}}},Ft=le(Nt,[["__scopeId","data-v-1b927357"]]);export{Ft as default};
