const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CardGrid-xDetXc2J.js","assets/index-COWSpSja.js","assets/CardGrid-fBB6b1za.css"])))=>i.map(i=>d[i]);
var _e=Object.defineProperty,we=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var Z=(h,u,d)=>u in h?_e(h,u,{enumerable:!0,configurable:!0,writable:!0,value:d}):h[u]=d,ee=(h,u)=>{for(var d in u||(u={}))xe.call(u,d)&&Z(h,d,u[d]);if(Y)for(var d of Y(u))Me.call(u,d)&&Z(h,d,u[d]);return h},te=(h,u)=>we(h,Ce(u));var w=(h,u,d)=>new Promise((m,p)=>{var $=y=>{try{b(d.next(y))}catch(S){p(S)}},r=y=>{try{b(d.throw(y))}catch(S){p(S)}},b=y=>y.done?m(y.value):Promise.resolve(y.value).then($,r);b((d=d.apply(h,u)).next())});import{_ as ie,r as c,c as o,F as L,a as U,o as s,b as t,d as g,t as f,n as F,e as ae,f as Se,g as Ie,h as $e,i as P,w as C,v as V,j as le,u as Be,k as Le,l as j,T as G,m as H,p as oe,q as se,s as Ue,x as ne}from"./index-COWSpSja.js";import{g as Ee,a as Ve,b as Ae,c as re,l as ze,d as De,e as Ne,f as Pe}from"./api-7SDLWfnf.js";const Re={class:"menu-bar"},Fe=["onMouseenter","onMouseleave"],Te=["onClick"],qe=["onClick"],Oe={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},setup(h){const u=c(null);function d(p){u.value=p}function m(p){setTimeout(()=>{u.value===p&&(u.value=null)},100)}return(p,$)=>(s(),o("nav",Re,[(s(!0),o(L,null,U(h.menus,r=>(s(),o("div",{key:r.id,class:"menu-item",onMouseenter:b=>d(r.id),onMouseleave:b=>m(r.id)},[t("button",{onClick:b=>p.$emit("select",r),class:F({active:r.id===h.activeId})},f(r.name),11,Te),r.subMenus&&r.subMenus.length>0?(s(),o("div",{key:0,class:F(["sub-menu",{show:u.value===r.id}])},[(s(!0),o(L,null,U(r.subMenus,b=>(s(),o("button",{key:b.id,onClick:y=>p.$emit("select",b,r),class:F([{active:b.id===h.activeSubMenuId},"sub-menu-item"])},f(b.name),11,qe))),128))],2)):g("",!0)],40,Fe))),128))]))}},je=ie(Oe,[["__scopeId","data-v-16a94230"]]),Ge={class:"home-container"},He={class:"menu-bar-fixed"},Je={class:"search-section"},Ke={class:"search-box-wrapper"},Qe={class:"search-engine-select"},We=["onClick"],Xe={class:"search-container"},Ye=["placeholder"],Ze={key:0,class:"ad-space-fixed left-ad-fixed"},et=["href"],tt=["src"],at={key:1,class:"ad-space-fixed right-ad-fixed"},lt=["href"],ot=["src"],st=["disabled"],nt={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},rt={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},it={key:"plus",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},dt={key:"close",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},ut={class:"modal-header"},ct={class:"modal-body"},vt={key:0,class:"batch-step"},ht={class:"remember-password-wrapper"},pt={key:0,class:"batch-error"},bt={class:"batch-actions"},gt=["disabled"],ft={key:1,class:"batch-step"},mt={key:0,class:"batch-error"},kt={class:"batch-actions"},yt=["disabled"],_t={key:2,class:"batch-step"},wt={class:"batch-preview-list"},Ct=["onUpdate:modelValue","id"],xt={class:"batch-card-preview"},Mt=["src","alt"],St={class:"batch-card-info"},It={class:"batch-edit-field"},$t=["onUpdate:modelValue"],Bt={class:"batch-edit-field"},Lt=["onUpdate:modelValue"],Ut={class:"batch-edit-field"},Et=["onUpdate:modelValue"],Vt={class:"batch-card-url"},At={key:0,class:"batch-card-warning"},zt={key:0,class:"batch-error"},Dt={class:"batch-actions"},Nt=["disabled"],Pt={class:"footer"},Rt={class:"footer-content"},Ft={class:"modal-header"},Tt={class:"modal-body"},qt={class:"friend-links-grid"},Ot=["href"],jt={class:"friend-link-logo"},Gt=["src","alt"],Ht={key:1,class:"friend-link-placeholder"},Jt={class:"friend-link-info"},Kt={__name:"Home",setup(h){const u=Le(()=>Ue(()=>import("./CardGrid-xDetXc2J.js"),__vite__mapDeps([0,1,2]))),d=c([]),m=c(null),p=c(null),$=c([]),r=c(""),b=c([]),y=c([]),S=c(!1),J=c([]),T=c(!1),_=c(1),x=c(""),A=c(""),k=c(!1),v=c(""),z=c([]),E=c(!1),B=c(!1);function de(){B.value=!B.value}function K(){B.value&&(B.value=!1)}const D=c(!1),Q=ae(()=>z.value.filter(l=>l.selected).length),q=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:l=>`https://www.google.com/search?q=${encodeURIComponent(l)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:l=>`https://www.baidu.com/s?wd=${encodeURIComponent(l)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:l=>`https://www.bing.com/search?q=${encodeURIComponent(l)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:l=>`https://github.com/search?q=${encodeURIComponent(l)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:l=>`/search?query=${encodeURIComponent(l)}`}],N=c((()=>{try{const l=localStorage.getItem("default_search_engine");if(l){const e=q.find(i=>i.name===l);if(e)return e}}catch(l){console.error("Failed to load default search engine:",l)}return q[0]})());function ue(l){N.value=l;try{localStorage.setItem("default_search_engine",l.name)}catch(e){console.error("Failed to save default search engine:",e)}}function ce(){r.value=""}const ve=ae(()=>r.value?$.value.filter(l=>l.title.toLowerCase().includes(r.value.toLowerCase())||l.url.toLowerCase().includes(r.value.toLowerCase())):$.value);Se(()=>{const l=localStorage.getItem("nav_background");l&&document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".home-container");e&&(e.style.backgroundImage=`url(${l})`,e.style.backgroundSize="cover",e.style.backgroundPosition="center",e.style.backgroundRepeat="no-repeat",e.style.backgroundAttachment="fixed")})}),Ie(()=>w(null,null,function*(){const l=yield Ee();d.value=l.data,d.value.length&&(m.value=d.value[0],O());const e=yield Ve();b.value=e.data.filter(a=>a.position==="left"),y.value=e.data.filter(a=>a.position==="right");const i=yield Ae();J.value=i.data;const n=localStorage.getItem("nav_background");if(n){const a=document.querySelector(".home-container");a&&!a.style.backgroundImage.includes(n)&&(a.style.backgroundImage=`url(${n})`,a.style.backgroundSize="cover",a.style.backgroundPosition="center",a.style.backgroundRepeat="no-repeat",a.style.backgroundAttachment="fixed")}ge(),document.addEventListener("click",K)})),$e(()=>{document.removeEventListener("click",K)});function he(l,e=null){return w(this,null,function*(){e?(m.value=e,p.value=l):(m.value=l,p.value=null),O()})}function O(){return w(this,null,function*(){var e;if(!m.value)return;const l=yield re(m.value.id,(e=p.value)==null?void 0:e.id);$.value=l.data})}function W(){return w(this,null,function*(){if(r.value.trim())if(N.value.name==="site"){let l=!1;for(const e of d.value){const i=yield re(e.id),n=i.data.find(a=>a.title.toLowerCase().includes(r.value.toLowerCase())||a.url.toLowerCase().includes(r.value.toLowerCase()));if(n){m.value=e,$.value=i.data,setTimeout(()=>{const a=document.querySelector(`[data-card-id='${n.id}']`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},100),l=!0;break}}l||alert("未找到相关内容")}else{const l=N.value.url(r.value);window.open(l,"_blank")}})}function pe(l){l.target.style.display="none",l.target.nextElementSibling.style.display="flex"}function be(){return w(this,null,function*(){T.value=!0,v.value="";const l=localStorage.getItem("nav_password_token");if(l)try{const{password:e,expiry:i,token:n}=JSON.parse(l);if(Date.now()<i&&n){localStorage.setItem("token",n),x.value=e,E.value=!0,_.value=2;return}else localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}_.value=1})}function R(){T.value=!1,_.value=1,x.value="",A.value="",v.value="",z.value=[],k.value=!1}function ge(){const l=localStorage.getItem("nav_password_token");if(l)try{const{password:e,expiry:i,token:n}=JSON.parse(l);Date.now()<i?(x.value=e,E.value=!0,n&&localStorage.setItem("token",n)):localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}}function X(){return w(this,null,function*(){if(!x.value){v.value="请输入密码";return}k.value=!0,v.value="";try{const l=yield ze("admin",x.value);if(l.data&&l.data.token)localStorage.setItem("token",l.data.token);else throw new Error("登录成功，但未收到 token");if(E.value){const e=Date.now()+72e5;localStorage.setItem("nav_password_token",JSON.stringify({password:x.value,token:l.data.token,expiry:e}))}else localStorage.removeItem("nav_password_token");_.value=2}catch(l){v.value="密码错误，请重试",console.error("密码验证失败:",l)}finally{k.value=!1}})}function fe(){localStorage.removeItem("nav_password_token"),localStorage.removeItem("token"),x.value="",E.value=!1,_.value=1}function me(){return w(this,null,function*(){var e,i;const l=A.value.split(`
`).map(n=>n.trim()).filter(n=>n.length>0);if(l.length===0){v.value="请输入至少一个网址";return}k.value=!0,v.value="";try{const n=yield De(l);z.value=n.data.data.map(a=>te(ee({},a),{selected:!0})),_.value=3}catch(n){v.value=((i=(e=n.response)==null?void 0:e.data)==null?void 0:i.error)||"解析失败，请重试"}finally{k.value=!1}})}function ke(){return w(this,null,function*(){var e,i,n;const l=z.value.filter(a=>a.selected);if(l.length===0){v.value="请至少选择一个网站";return}k.value=!0,v.value="";try{const a=l.map(I=>({title:I.title,url:I.url,logo:I.logo,description:I.description}));yield Ne(m.value.id,((e=p.value)==null?void 0:e.id)||null,a),alert(`成功添加 ${l.length} 个网站！`),R(),yield O()}catch(a){v.value=((n=(i=a.response)==null?void 0:i.data)==null?void 0:n.error)||"添加失败，请重试"}finally{k.value=!1}})}function ye(){return w(this,null,function*(){if(!D.value){D.value=!0;try{const e=(yield Pe()).data.url;let i=document.getElementById("dynamic-bg-style");i||(i=document.createElement("style"),i.id="dynamic-bg-style",document.head.appendChild(i)),i.textContent=`.home-container { background-image: url(${e}) !important; }`,localStorage.setItem("nav_background",e)}catch(l){console.error("获取壁纸失败:",l),alert("获取壁纸失败，请稍后重试")}finally{D.value=!1}}})}return(l,e)=>{var i,n;return s(),o("div",Ge,[t("div",He,[P(je,{menus:d.value,activeId:(i=m.value)==null?void 0:i.id,activeSubMenuId:(n=p.value)==null?void 0:n.id,onSelect:he},null,8,["menus","activeId","activeSubMenuId"])]),t("div",Je,[t("div",Ke,[t("div",Qe,[(s(),o(L,null,U(q,a=>t("button",{key:a.name,class:F(["engine-btn",{active:N.value.name===a.name}]),onClick:I=>ue(a)},f(a.label),11,We)),64))]),t("div",Xe,[C(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),type:"text",placeholder:N.value.placeholder,class:"search-input",onKeyup:le(W,["enter"])},null,40,Ye),[[V,r.value]]),r.value?(s(),o("button",{key:0,class:"clear-btn",onClick:ce,"aria-label":"清空",title:"clear"},e[12]||(e[12]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):g("",!0),t("button",{onClick:W,class:"search-btn",title:"search"},e[13]||(e[13]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[t("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])]),b.value.length?(s(),o("div",Ze,[(s(!0),o(L,null,U(b.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank"},[t("img",{src:a.img,alt:"广告",loading:"lazy"},null,8,tt)],8,et))),128))])):g("",!0),y.value.length?(s(),o("div",at,[(s(!0),o(L,null,U(y.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank"},[t("img",{src:a.img,alt:"广告",loading:"lazy"},null,8,ot)],8,lt))),128))])):g("",!0),P(Be(u),{cards:ve.value},null,8,["cards"]),t("div",{class:"fab-container",onClick:e[1]||(e[1]=H(()=>{},["stop"]))},[P(G,{name:"fab-item"},{default:j(()=>[C(t("button",{onClick:ye,class:"change-bg-btn",title:"切换背景",disabled:D.value},[D.value?(s(),o("svg",rt,e[15]||(e[15]=[t("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"},null,-1)]))):(s(),o("svg",nt,e[14]||(e[14]=[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},null,-1),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"},null,-1),t("path",{d:"M21 15l-5-5L5 21"},null,-1)])))],8,st),[[ne,B.value]])]),_:1}),P(G,{name:"fab-item"},{default:j(()=>[m.value?C((s(),o("button",{key:0,onClick:be,class:"batch-add-btn",title:"批量添加网站"},e[16]||(e[16]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 5v14M5 12h14"})],-1)]),512)),[[ne,B.value]]):g("",!0)]),_:1}),t("button",{onClick:de,class:"fab-toggle-btn",title:"更多功能"},[P(G,{name:"fab-icon",mode:"out-in"},{default:j(()=>[B.value?(s(),o("svg",dt,e[18]||(e[18]=[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),t("line",{x1:"6",y1:"6",x2:"18",y2:"12"},null,-1)]))):(s(),o("svg",it,e[17]||(e[17]=[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1)])))]),_:1})])]),T.value?(s(),o("div",{key:2,class:"modal-overlay",onClick:R},[t("div",{class:"modal-content batch-modal",onClick:e[7]||(e[7]=H(()=>{},["stop"]))},[t("div",ut,[t("h3",null,f(_.value===1?"验证密码":_.value===2?"输入网址":"预览并选择"),1),t("button",{onClick:R,class:"close-btn"},e[19]||(e[19]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",ct,[_.value===1?(s(),o("div",vt,[e[21]||(e[21]=t("p",{class:"batch-tip"},"请输入管理员密码以继续：",-1)),C(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>x.value=a),type:"password",placeholder:"请输入管理员密码",class:"batch-input",onKeyup:le(X,["enter"])},null,544),[[V,x.value]]),t("div",ht,[t("label",null,[C(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>E.value=a)},null,512),[[oe,E.value]]),e[20]||(e[20]=t("span",null,"记住密码（2小时）",-1))])]),v.value?(s(),o("p",pt,f(v.value),1)):g("",!0),t("div",bt,[t("button",{onClick:R,class:"btn btn-cancel"},"取消"),t("button",{onClick:X,class:"btn btn-primary",disabled:k.value},f(k.value?"验证中...":"确认"),9,gt)])])):g("",!0),_.value===2?(s(),o("div",ft,[e[22]||(e[22]=t("p",{class:"batch-tip"},"请输入需要添加的网址，每行一个：",-1)),C(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=a=>A.value=a),placeholder:`例如：
https://github.com
https://google.com
https://stackoverflow.com`,class:"batch-textarea",rows:"10"},null,512),[[V,A.value]]),v.value?(s(),o("p",mt,f(v.value),1)):g("",!0),t("div",kt,[t("button",{onClick:fe,class:"btn btn-cancel"},"上一步"),t("button",{onClick:me,class:"btn btn-primary",disabled:k.value||!A.value.trim()},f(k.value?"解析中...":"下一步"),9,yt)])])):g("",!0),_.value===3?(s(),o("div",_t,[e[26]||(e[26]=t("p",{class:"batch-tip"},"请选择需要添加的网站：",-1)),t("div",wt,[(s(!0),o(L,null,U(z.value,(a,I)=>(s(),o("div",{key:I,class:"batch-preview-item"},[C(t("input",{type:"checkbox","onUpdate:modelValue":M=>a.selected=M,id:`card-${I}`},null,8,Ct),[[oe,a.selected]]),t("div",xt,[t("img",{src:a.logo,alt:a.title,class:"batch-card-logo",onError:e[5]||(e[5]=M=>M.target.src="/default-favicon.png")},null,40,Mt),t("div",St,[t("div",It,[e[23]||(e[23]=t("label",null,"标题：",-1)),C(t("input",{type:"text","onUpdate:modelValue":M=>a.title=M,class:"batch-edit-input"},null,8,$t),[[V,a.title]])]),t("div",Bt,[e[24]||(e[24]=t("label",null,"Logo：",-1)),C(t("input",{type:"text","onUpdate:modelValue":M=>a.logo=M,class:"batch-edit-input"},null,8,Lt),[[V,a.logo]])]),t("div",Ut,[e[25]||(e[25]=t("label",null,"描述：",-1)),C(t("textarea",{"onUpdate:modelValue":M=>a.description=M,class:"batch-edit-textarea",rows:"2"},null,8,Et),[[V,a.description]])]),t("p",Vt,f(a.url),1),a.success?g("",!0):(s(),o("p",At,"⚠️ "+f(a.error),1))])])]))),128))]),v.value?(s(),o("p",zt,f(v.value),1)):g("",!0),t("div",Dt,[t("button",{onClick:e[6]||(e[6]=a=>_.value=2),class:"btn btn-cancel"},"上一步"),t("button",{onClick:ke,class:"btn btn-primary",disabled:k.value||Q.value===0},f(k.value?"添加中...":`添加 (${Q.value})`),9,Nt)])])):g("",!0)])])])):g("",!0),t("footer",Pt,[t("div",Rt,[t("button",{onClick:e[8]||(e[8]=a=>S.value=!0),class:"friend-link-btn"},e[27]||(e[27]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),t("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),se(" 友情链接 ")])),e[28]||(e[28]=t("p",{class:"copyright"},[se("Copyright © 2025 Nav-Item | "),t("a",{href:"https://github.com/zczy-k/nav-item",target:"_blank",class:"footer-link"},"Powered by zczy-k")],-1))])]),S.value?(s(),o("div",{key:3,class:"modal-overlay",onClick:e[11]||(e[11]=a=>S.value=!1)},[t("div",{class:"modal-content",onClick:e[10]||(e[10]=H(()=>{},["stop"]))},[t("div",Ft,[e[30]||(e[30]=t("h3",null,"友情链接",-1)),t("button",{onClick:e[9]||(e[9]=a=>S.value=!1),class:"close-btn"},e[29]||(e[29]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",Tt,[t("div",qt,[(s(!0),o(L,null,U(J.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank",class:"friend-link-card"},[t("div",jt,[a.logo?(s(),o("img",{key:0,src:a.logo,alt:a.title,loading:"lazy",onError:pe},null,40,Gt)):(s(),o("div",Ht,f(a.title.charAt(0)),1))]),t("div",Jt,[t("h4",null,f(a.title),1)])],8,Ot))),128))])])])])):g("",!0)])}}},Zt=ie(Kt,[["__scopeId","data-v-80622b00"]]);export{Zt as default};
