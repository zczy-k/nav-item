const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CardGrid-CGWbOGbG.js","assets/index-zwpTk2Rr.js","assets/CardGrid-fBB6b1za.css"])))=>i.map(i=>d[i]);
var be=Object.defineProperty,fe=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var K=(h,u,d)=>u in h?be(h,u,{enumerable:!0,configurable:!0,writable:!0,value:d}):h[u]=d,j=(h,u)=>{for(var d in u||(u={}))ke.call(u,d)&&K(h,d,u[d]);if(J)for(var d of J(u))me.call(u,d)&&K(h,d,u[d]);return h},Q=(h,u)=>fe(h,ge(u));var y=(h,u,d)=>new Promise((k,p)=>{var $=_=>{try{b(d.next(_))}catch(x){p(x)}},r=_=>{try{b(d.throw(_))}catch(x){p(x)}},b=_=>_.done?k(_.value):Promise.resolve(_.value).then($,r);b((d=d.apply(h,u)).next())});import{_ as ae,r as c,c as o,F as U,a as B,o as s,b as t,d as f,t as g,n as R,e as W,f as _e,g as X,w as I,v as V,h as Y,u as we,i as ye,j as Z,k as ee,l as te,m as Ce}from"./index-zwpTk2Rr.js";import{g as Me,a as xe,b as Se,c as le,d as Ie,l as $e,e as Ue,f as Be}from"./api-KwLLGkf8.js";const Le={class:"menu-bar"},Ve=["onMouseenter","onMouseleave"],Ae=["onClick"],Ee=["onClick"],ze={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},setup(h){const u=c(null);function d(p){u.value=p}function k(p){setTimeout(()=>{u.value===p&&(u.value=null)},100)}return(p,$)=>(s(),o("nav",Le,[(s(!0),o(U,null,B(h.menus,r=>(s(),o("div",{key:r.id,class:"menu-item",onMouseenter:b=>d(r.id),onMouseleave:b=>k(r.id)},[t("button",{onClick:b=>p.$emit("select",r),class:R({active:r.id===h.activeId})},g(r.name),11,Ae),r.subMenus&&r.subMenus.length>0?(s(),o("div",{key:0,class:R(["sub-menu",{show:u.value===r.id}])},[(s(!0),o(U,null,B(r.subMenus,b=>(s(),o("button",{key:b.id,onClick:_=>p.$emit("select",b,r),class:R([{active:b.id===h.activeSubMenuId},"sub-menu-item"])},g(b.name),11,Ee))),128))],2)):f("",!0)],40,Ve))),128))]))}},Ne=ae(ze,[["__scopeId","data-v-16a94230"]]),Pe={class:"home-container"},Re={class:"menu-bar-fixed"},De={class:"search-section"},Te={class:"search-box-wrapper"},qe={class:"search-engine-select"},Fe=["onClick"],Ge={class:"search-container"},Oe=["placeholder"],He={key:0,class:"ad-space-fixed left-ad-fixed"},Je=["href"],Ke=["src"],je={key:1,class:"ad-space-fixed right-ad-fixed"},Qe=["href"],We=["src"],Xe=["disabled"],Ye={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ze={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},et={class:"modal-header"},tt={class:"modal-body"},lt={key:0,class:"batch-step"},at={class:"remember-password-wrapper"},ot={key:0,class:"batch-error"},st={class:"batch-actions"},nt=["disabled"],rt={key:1,class:"batch-step"},it={key:0,class:"batch-error"},dt={class:"batch-actions"},ut=["disabled"],ct={key:2,class:"batch-step"},vt={class:"batch-preview-list"},ht=["onUpdate:modelValue","id"],pt={class:"batch-card-preview"},bt=["src","alt"],ft={class:"batch-card-info"},gt={class:"batch-edit-field"},kt=["onUpdate:modelValue"],mt={class:"batch-edit-field"},_t=["onUpdate:modelValue"],wt={class:"batch-edit-field"},yt=["onUpdate:modelValue"],Ct={class:"batch-card-url"},Mt={key:0,class:"batch-card-warning"},xt={key:0,class:"batch-error"},St={class:"batch-actions"},It=["disabled"],$t={class:"footer"},Ut={class:"footer-content"},Bt={class:"modal-header"},Lt={class:"modal-body"},Vt={class:"friend-links-grid"},At=["href"],Et={class:"friend-link-logo"},zt=["src","alt"],Nt={key:1,class:"friend-link-placeholder"},Pt={class:"friend-link-info"},Rt={__name:"Home",setup(h){const u=ye(()=>Ce(()=>import("./CardGrid-CGWbOGbG.js"),__vite__mapDeps([0,1,2]))),d=c([]),k=c(null),p=c(null),$=c([]),r=c(""),b=c([]),_=c([]),x=c(!1),q=c([]),D=c(!1),w=c(1),C=c(""),A=c(""),m=c(!1),v=c(""),E=c([]),L=c(!1),z=c(!1),F=W(()=>E.value.filter(a=>a.selected).length),G=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:a=>`https://www.google.com/search?q=${encodeURIComponent(a)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:a=>`https://www.baidu.com/s?wd=${encodeURIComponent(a)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:a=>`https://www.bing.com/search?q=${encodeURIComponent(a)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:a=>`https://github.com/search?q=${encodeURIComponent(a)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:a=>`/search?query=${encodeURIComponent(a)}`}],N=c(G[0]);function oe(a){N.value=a}function se(){r.value=""}const ne=W(()=>r.value?$.value.filter(a=>a.title.toLowerCase().includes(r.value.toLowerCase())||a.url.toLowerCase().includes(r.value.toLowerCase())):$.value);_e(()=>y(null,null,function*(){const a=yield Me();d.value=a.data,d.value.length&&(k.value=d.value[0],T());const e=yield xe();b.value=e.data.filter(n=>n.position==="left"),_.value=e.data.filter(n=>n.position==="right");const i=yield Se();q.value=i.data,ue()}));function re(a,e=null){return y(this,null,function*(){e?(k.value=e,p.value=a):(k.value=a,p.value=null),T()})}function T(){return y(this,null,function*(){var e;if(!k.value)return;const a=yield le(k.value.id,(e=p.value)==null?void 0:e.id);$.value=a.data})}function O(){return y(this,null,function*(){if(r.value.trim())if(N.value.name==="site"){let a=!1;for(const e of d.value){const i=yield le(e.id),n=i.data.find(l=>l.title.toLowerCase().includes(r.value.toLowerCase())||l.url.toLowerCase().includes(r.value.toLowerCase()));if(n){k.value=e,$.value=i.data,setTimeout(()=>{const l=document.querySelector(`[data-card-id='${n.id}']`);l&&l.scrollIntoView({behavior:"smooth",block:"center"})},100),a=!0;break}}a||alert("未找到相关内容")}else{const a=N.value.url(r.value);window.open(a,"_blank")}})}function ie(a){a.target.style.display="none",a.target.nextElementSibling.style.display="flex"}function de(){return y(this,null,function*(){D.value=!0,v.value="";const a=localStorage.getItem("nav_password_token");if(a)try{const{password:e,expiry:i,token:n}=JSON.parse(a);if(Date.now()<i&&n){localStorage.setItem("token",n),C.value=e,L.value=!0,w.value=2;return}else localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}w.value=1})}function P(){D.value=!1,w.value=1,C.value="",A.value="",v.value="",E.value=[],m.value=!1}function ue(){const a=localStorage.getItem("nav_password_token");if(a)try{const{password:e,expiry:i,token:n}=JSON.parse(a);Date.now()<i?(C.value=e,L.value=!0,n&&localStorage.setItem("token",n)):localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}}function H(){return y(this,null,function*(){if(!C.value){v.value="请输入密码";return}m.value=!0,v.value="";try{const a=yield $e("admin",C.value);if(a.data&&a.data.token)localStorage.setItem("token",a.data.token);else throw new Error("登录成功，但未收到 token");if(L.value){const e=Date.now()+72e5;localStorage.setItem("nav_password_token",JSON.stringify({password:C.value,token:a.data.token,expiry:e}))}else localStorage.removeItem("nav_password_token");w.value=2}catch(a){v.value="密码错误，请重试",console.error("密码验证失败:",a)}finally{m.value=!1}})}function ce(){localStorage.removeItem("nav_password_token"),localStorage.removeItem("token"),C.value="",L.value=!1,w.value=1}function ve(){return y(this,null,function*(){var e,i;const a=A.value.split(`
`).map(n=>n.trim()).filter(n=>n.length>0);if(a.length===0){v.value="请输入至少一个网址";return}m.value=!0,v.value="";try{const n=yield Ue(a);E.value=n.data.data.map(l=>Q(j({},l),{selected:!0})),w.value=3}catch(n){v.value=((i=(e=n.response)==null?void 0:e.data)==null?void 0:i.error)||"解析失败，请重试"}finally{m.value=!1}})}function he(){return y(this,null,function*(){var e,i,n;const a=E.value.filter(l=>l.selected);if(a.length===0){v.value="请至少选择一个网站";return}m.value=!0,v.value="";try{const l=a.map(S=>({title:S.title,url:S.url,logo:S.logo,description:S.description}));yield Be(k.value.id,((e=p.value)==null?void 0:e.id)||null,l),alert(`成功添加 ${a.length} 个网站！`),P(),yield T()}catch(l){v.value=((n=(i=l.response)==null?void 0:i.data)==null?void 0:n.error)||"添加失败，请重试"}finally{m.value=!1}})}function pe(){return y(this,null,function*(){if(!z.value){z.value=!0;try{const e=(yield Ie()).data.url,i=document.querySelector(".home-container");i&&(i.style.backgroundImage=`url(${e})`,i.style.backgroundSize="cover",i.style.backgroundPosition="center",i.style.backgroundRepeat="no-repeat",i.style.backgroundAttachment="fixed")}catch(a){console.error("获取壁纸失败:",a),alert("获取壁纸失败，请稍后重试")}finally{z.value=!1}}})}return(a,e)=>{var i,n;return s(),o("div",Pe,[t("div",Re,[X(Ne,{menus:d.value,activeId:(i=k.value)==null?void 0:i.id,activeSubMenuId:(n=p.value)==null?void 0:n.id,onSelect:re},null,8,["menus","activeId","activeSubMenuId"])]),t("div",De,[t("div",Te,[t("div",qe,[(s(),o(U,null,B(G,l=>t("button",{key:l.name,class:R(["engine-btn",{active:N.value.name===l.name}]),onClick:S=>oe(l)},g(l.label),11,Fe)),64))]),t("div",Ge,[I(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l),type:"text",placeholder:N.value.placeholder,class:"search-input",onKeyup:Y(O,["enter"])},null,40,Oe),[[V,r.value]]),r.value?(s(),o("button",{key:0,class:"clear-btn",onClick:se,"aria-label":"清空",title:"clear"},e[11]||(e[11]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):f("",!0),t("button",{onClick:O,class:"search-btn",title:"search"},e[12]||(e[12]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[t("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])]),b.value.length?(s(),o("div",He,[(s(!0),o(U,null,B(b.value,l=>(s(),o("a",{key:l.id,href:l.url,target:"_blank"},[t("img",{src:l.img,alt:"广告",loading:"lazy"},null,8,Ke)],8,Je))),128))])):f("",!0),_.value.length?(s(),o("div",je,[(s(!0),o(U,null,B(_.value,l=>(s(),o("a",{key:l.id,href:l.url,target:"_blank"},[t("img",{src:l.img,alt:"广告",loading:"lazy"},null,8,We)],8,Qe))),128))])):f("",!0),X(we(u),{cards:ne.value},null,8,["cards"]),k.value?(s(),o("button",{key:2,onClick:de,class:"batch-add-btn",title:"批量添加网站"},e[13]||(e[13]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 5v14M5 12h14"})],-1)]))):f("",!0),t("button",{onClick:pe,class:"change-bg-btn",title:"切换背景",disabled:z.value},[z.value?(s(),o("svg",Ze,e[15]||(e[15]=[t("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"},null,-1)]))):(s(),o("svg",Ye,e[14]||(e[14]=[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},null,-1),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"},null,-1),t("path",{d:"M21 15l-5-5L5 21"},null,-1)])))],8,Xe),D.value?(s(),o("div",{key:3,class:"modal-overlay",onClick:P},[t("div",{class:"modal-content batch-modal",onClick:e[6]||(e[6]=ee(()=>{},["stop"]))},[t("div",et,[t("h3",null,g(w.value===1?"验证密码":w.value===2?"输入网址":"预览并选择"),1),t("button",{onClick:P,class:"close-btn"},e[16]||(e[16]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",tt,[w.value===1?(s(),o("div",lt,[e[18]||(e[18]=t("p",{class:"batch-tip"},"请输入管理员密码以继续：",-1)),I(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>C.value=l),type:"password",placeholder:"请输入管理员密码",class:"batch-input",onKeyup:Y(H,["enter"])},null,544),[[V,C.value]]),t("div",at,[t("label",null,[I(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=l=>L.value=l)},null,512),[[Z,L.value]]),e[17]||(e[17]=t("span",null,"记住密码（2小时）",-1))])]),v.value?(s(),o("p",ot,g(v.value),1)):f("",!0),t("div",st,[t("button",{onClick:P,class:"btn btn-cancel"},"取消"),t("button",{onClick:H,class:"btn btn-primary",disabled:m.value},g(m.value?"验证中...":"确认"),9,nt)])])):f("",!0),w.value===2?(s(),o("div",rt,[e[19]||(e[19]=t("p",{class:"batch-tip"},"请输入需要添加的网址，每行一个：",-1)),I(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>A.value=l),placeholder:`例如：
https://github.com
https://google.com
https://stackoverflow.com`,class:"batch-textarea",rows:"10"},null,512),[[V,A.value]]),v.value?(s(),o("p",it,g(v.value),1)):f("",!0),t("div",dt,[t("button",{onClick:ce,class:"btn btn-cancel"},"上一步"),t("button",{onClick:ve,class:"btn btn-primary",disabled:m.value||!A.value.trim()},g(m.value?"解析中...":"下一步"),9,ut)])])):f("",!0),w.value===3?(s(),o("div",ct,[e[23]||(e[23]=t("p",{class:"batch-tip"},"请选择需要添加的网站：",-1)),t("div",vt,[(s(!0),o(U,null,B(E.value,(l,S)=>(s(),o("div",{key:S,class:"batch-preview-item"},[I(t("input",{type:"checkbox","onUpdate:modelValue":M=>l.selected=M,id:`card-${S}`},null,8,ht),[[Z,l.selected]]),t("div",pt,[t("img",{src:l.logo,alt:l.title,class:"batch-card-logo",onError:e[4]||(e[4]=M=>M.target.src="/default-favicon.png")},null,40,bt),t("div",ft,[t("div",gt,[e[20]||(e[20]=t("label",null,"标题：",-1)),I(t("input",{type:"text","onUpdate:modelValue":M=>l.title=M,class:"batch-edit-input"},null,8,kt),[[V,l.title]])]),t("div",mt,[e[21]||(e[21]=t("label",null,"Logo：",-1)),I(t("input",{type:"text","onUpdate:modelValue":M=>l.logo=M,class:"batch-edit-input"},null,8,_t),[[V,l.logo]])]),t("div",wt,[e[22]||(e[22]=t("label",null,"描述：",-1)),I(t("textarea",{"onUpdate:modelValue":M=>l.description=M,class:"batch-edit-textarea",rows:"2"},null,8,yt),[[V,l.description]])]),t("p",Ct,g(l.url),1),l.success?f("",!0):(s(),o("p",Mt,"⚠️ "+g(l.error),1))])])]))),128))]),v.value?(s(),o("p",xt,g(v.value),1)):f("",!0),t("div",St,[t("button",{onClick:e[5]||(e[5]=l=>w.value=2),class:"btn btn-cancel"},"上一步"),t("button",{onClick:he,class:"btn btn-primary",disabled:m.value||F.value===0},g(m.value?"添加中...":`添加 (${F.value})`),9,It)])])):f("",!0)])])])):f("",!0),t("footer",$t,[t("div",Ut,[t("button",{onClick:e[7]||(e[7]=l=>x.value=!0),class:"friend-link-btn"},e[24]||(e[24]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),t("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),te(" 友情链接 ")])),e[25]||(e[25]=t("p",{class:"copyright"},[te("Copyright © 2025 Nav-Item | "),t("a",{href:"https://github.com/zczy-k/nav-item",target:"_blank",class:"footer-link"},"Powered by zczy-k")],-1))])]),x.value?(s(),o("div",{key:4,class:"modal-overlay",onClick:e[10]||(e[10]=l=>x.value=!1)},[t("div",{class:"modal-content",onClick:e[9]||(e[9]=ee(()=>{},["stop"]))},[t("div",Bt,[e[27]||(e[27]=t("h3",null,"友情链接",-1)),t("button",{onClick:e[8]||(e[8]=l=>x.value=!1),class:"close-btn"},e[26]||(e[26]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",Lt,[t("div",Vt,[(s(!0),o(U,null,B(q.value,l=>(s(),o("a",{key:l.id,href:l.url,target:"_blank",class:"friend-link-card"},[t("div",Et,[l.logo?(s(),o("img",{key:0,src:l.logo,alt:l.title,loading:"lazy",onError:ie},null,40,zt)):(s(),o("div",Nt,g(l.title.charAt(0)),1))]),t("div",Pt,[t("h4",null,g(l.title),1)])],8,At))),128))])])])])):f("",!0)])}}},Ft=ae(Rt,[["__scopeId","data-v-262801da"]]);export{Ft as default};
