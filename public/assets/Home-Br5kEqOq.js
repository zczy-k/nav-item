const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CardGrid-B2N2pDOG.js","assets/index-CakK1wZ6.js","assets/CardGrid-fBB6b1za.css"])))=>i.map(i=>d[i]);
var ge=Object.defineProperty,be=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var K=(h,c,d)=>c in h?ge(h,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):h[c]=d,j=(h,c)=>{for(var d in c||(c={}))fe.call(c,d)&&K(h,d,c[d]);if(J)for(var d of J(c))ke.call(c,d)&&K(h,d,c[d]);return h},Q=(h,c)=>be(h,me(c));var w=(h,c,d)=>new Promise((f,p)=>{var $=_=>{try{g(d.next(_))}catch(S){p(S)}},r=_=>{try{g(d.throw(_))}catch(S){p(S)}},g=_=>_.done?f(_.value):Promise.resolve(_.value).then($,r);g((d=d.apply(h,c)).next())});import{_ as le,r as u,c as o,F as B,a as L,o as s,b as t,d as b,t as m,n as P,e as W,f as _e,g as ye,h as X,w as x,v as E,i as Y,u as we,j as Ce,k as Z,l as ee,m as te,p as Me}from"./index-CakK1wZ6.js";import{g as Se,a as Ie,b as xe,c as ae,d as $e,l as Be,e as Le,f as Ue}from"./api-KwLLGkf8.js";const Ee={class:"menu-bar"},Ve=["onMouseenter","onMouseleave"],Ae=["onClick"],ze=["onClick"],De={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},setup(h){const c=u(null);function d(p){c.value=p}function f(p){setTimeout(()=>{c.value===p&&(c.value=null)},100)}return(p,$)=>(s(),o("nav",Ee,[(s(!0),o(B,null,L(h.menus,r=>(s(),o("div",{key:r.id,class:"menu-item",onMouseenter:g=>d(r.id),onMouseleave:g=>f(r.id)},[t("button",{onClick:g=>p.$emit("select",r),class:P({active:r.id===h.activeId})},m(r.name),11,Ae),r.subMenus&&r.subMenus.length>0?(s(),o("div",{key:0,class:P(["sub-menu",{show:c.value===r.id}])},[(s(!0),o(B,null,L(r.subMenus,g=>(s(),o("button",{key:g.id,onClick:_=>p.$emit("select",g,r),class:P([{active:g.id===h.activeSubMenuId},"sub-menu-item"])},m(g.name),11,ze))),128))],2)):b("",!0)],40,Ve))),128))]))}},Ne=le(De,[["__scopeId","data-v-16a94230"]]),Pe={class:"home-container"},Re={class:"menu-bar-fixed"},qe={class:"search-section"},Te={class:"search-box-wrapper"},Fe={class:"search-engine-select"},Oe=["onClick"],Ge={class:"search-container"},He=["placeholder"],Je={key:0,class:"ad-space-fixed left-ad-fixed"},Ke=["href"],je=["src"],Qe={key:1,class:"ad-space-fixed right-ad-fixed"},We=["href"],Xe=["src"],Ye=["disabled"],Ze={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},et={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},tt={class:"modal-header"},at={class:"modal-body"},lt={key:0,class:"batch-step"},ot={class:"remember-password-wrapper"},st={key:0,class:"batch-error"},nt={class:"batch-actions"},rt=["disabled"],it={key:1,class:"batch-step"},dt={key:0,class:"batch-error"},ct={class:"batch-actions"},ut=["disabled"],vt={key:2,class:"batch-step"},ht={class:"batch-preview-list"},pt=["onUpdate:modelValue","id"],gt={class:"batch-card-preview"},bt=["src","alt"],mt={class:"batch-card-info"},ft={class:"batch-edit-field"},kt=["onUpdate:modelValue"],_t={class:"batch-edit-field"},yt=["onUpdate:modelValue"],wt={class:"batch-edit-field"},Ct=["onUpdate:modelValue"],Mt={class:"batch-card-url"},St={key:0,class:"batch-card-warning"},It={key:0,class:"batch-error"},xt={class:"batch-actions"},$t=["disabled"],Bt={class:"footer"},Lt={class:"footer-content"},Ut={class:"modal-header"},Et={class:"modal-body"},Vt={class:"friend-links-grid"},At=["href"],zt={class:"friend-link-logo"},Dt=["src","alt"],Nt={key:1,class:"friend-link-placeholder"},Pt={class:"friend-link-info"},Rt={__name:"Home",setup(h){const c=Ce(()=>Me(()=>import("./CardGrid-B2N2pDOG.js"),__vite__mapDeps([0,1,2]))),d=u([]),f=u(null),p=u(null),$=u([]),r=u(""),g=u([]),_=u([]),S=u(!1),F=u([]),R=u(!1),y=u(1),C=u(""),V=u(""),k=u(!1),v=u(""),A=u([]),U=u(!1),z=u(!1),O=W(()=>A.value.filter(l=>l.selected).length),q=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:l=>`https://www.google.com/search?q=${encodeURIComponent(l)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:l=>`https://www.baidu.com/s?wd=${encodeURIComponent(l)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:l=>`https://www.bing.com/search?q=${encodeURIComponent(l)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:l=>`https://github.com/search?q=${encodeURIComponent(l)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:l=>`/search?query=${encodeURIComponent(l)}`}],D=u((()=>{try{const l=localStorage.getItem("default_search_engine");if(l){const e=q.find(i=>i.name===l);if(e)return e}}catch(l){console.error("Failed to load default search engine:",l)}return q[0]})());function oe(l){D.value=l;try{localStorage.setItem("default_search_engine",l.name)}catch(e){console.error("Failed to save default search engine:",e)}}function se(){r.value=""}const ne=W(()=>r.value?$.value.filter(l=>l.title.toLowerCase().includes(r.value.toLowerCase())||l.url.toLowerCase().includes(r.value.toLowerCase())):$.value);_e(()=>{const l=localStorage.getItem("nav_background");l&&document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".home-container");e&&(e.style.backgroundImage=`url(${l})`,e.style.backgroundSize="cover",e.style.backgroundPosition="center",e.style.backgroundRepeat="no-repeat",e.style.backgroundAttachment="fixed")})}),ye(()=>w(null,null,function*(){const l=yield Se();d.value=l.data,d.value.length&&(f.value=d.value[0],T());const e=yield Ie();g.value=e.data.filter(a=>a.position==="left"),_.value=e.data.filter(a=>a.position==="right");const i=yield xe();F.value=i.data;const n=localStorage.getItem("nav_background");if(n){const a=document.querySelector(".home-container");a&&!a.style.backgroundImage.includes(n)&&(a.style.backgroundImage=`url(${n})`,a.style.backgroundSize="cover",a.style.backgroundPosition="center",a.style.backgroundRepeat="no-repeat",a.style.backgroundAttachment="fixed")}ce()}));function re(l,e=null){return w(this,null,function*(){e?(f.value=e,p.value=l):(f.value=l,p.value=null),T()})}function T(){return w(this,null,function*(){var e;if(!f.value)return;const l=yield ae(f.value.id,(e=p.value)==null?void 0:e.id);$.value=l.data})}function G(){return w(this,null,function*(){if(r.value.trim())if(D.value.name==="site"){let l=!1;for(const e of d.value){const i=yield ae(e.id),n=i.data.find(a=>a.title.toLowerCase().includes(r.value.toLowerCase())||a.url.toLowerCase().includes(r.value.toLowerCase()));if(n){f.value=e,$.value=i.data,setTimeout(()=>{const a=document.querySelector(`[data-card-id='${n.id}']`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})},100),l=!0;break}}l||alert("未找到相关内容")}else{const l=D.value.url(r.value);window.open(l,"_blank")}})}function ie(l){l.target.style.display="none",l.target.nextElementSibling.style.display="flex"}function de(){return w(this,null,function*(){R.value=!0,v.value="";const l=localStorage.getItem("nav_password_token");if(l)try{const{password:e,expiry:i,token:n}=JSON.parse(l);if(Date.now()<i&&n){localStorage.setItem("token",n),C.value=e,U.value=!0,y.value=2;return}else localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}y.value=1})}function N(){R.value=!1,y.value=1,C.value="",V.value="",v.value="",A.value=[],k.value=!1}function ce(){const l=localStorage.getItem("nav_password_token");if(l)try{const{password:e,expiry:i,token:n}=JSON.parse(l);Date.now()<i?(C.value=e,U.value=!0,n&&localStorage.setItem("token",n)):localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}}function H(){return w(this,null,function*(){if(!C.value){v.value="请输入密码";return}k.value=!0,v.value="";try{const l=yield Be("admin",C.value);if(l.data&&l.data.token)localStorage.setItem("token",l.data.token);else throw new Error("登录成功，但未收到 token");if(U.value){const e=Date.now()+72e5;localStorage.setItem("nav_password_token",JSON.stringify({password:C.value,token:l.data.token,expiry:e}))}else localStorage.removeItem("nav_password_token");y.value=2}catch(l){v.value="密码错误，请重试",console.error("密码验证失败:",l)}finally{k.value=!1}})}function ue(){localStorage.removeItem("nav_password_token"),localStorage.removeItem("token"),C.value="",U.value=!1,y.value=1}function ve(){return w(this,null,function*(){var e,i;const l=V.value.split(`
`).map(n=>n.trim()).filter(n=>n.length>0);if(l.length===0){v.value="请输入至少一个网址";return}k.value=!0,v.value="";try{const n=yield Le(l);A.value=n.data.data.map(a=>Q(j({},a),{selected:!0})),y.value=3}catch(n){v.value=((i=(e=n.response)==null?void 0:e.data)==null?void 0:i.error)||"解析失败，请重试"}finally{k.value=!1}})}function he(){return w(this,null,function*(){var e,i,n;const l=A.value.filter(a=>a.selected);if(l.length===0){v.value="请至少选择一个网站";return}k.value=!0,v.value="";try{const a=l.map(I=>({title:I.title,url:I.url,logo:I.logo,description:I.description}));yield Ue(f.value.id,((e=p.value)==null?void 0:e.id)||null,a),alert(`成功添加 ${l.length} 个网站！`),N(),yield T()}catch(a){v.value=((n=(i=a.response)==null?void 0:i.data)==null?void 0:n.error)||"添加失败，请重试"}finally{k.value=!1}})}function pe(){return w(this,null,function*(){if(!z.value){z.value=!0;try{const e=(yield $e()).data.url;let i=document.getElementById("dynamic-bg-style");i||(i=document.createElement("style"),i.id="dynamic-bg-style",document.head.appendChild(i)),i.textContent=`.home-container { background-image: url(${e}) !important; }`,localStorage.setItem("nav_background",e)}catch(l){console.error("获取壁纸失败:",l),alert("获取壁纸失败，请稍后重试")}finally{z.value=!1}}})}return(l,e)=>{var i,n;return s(),o("div",Pe,[t("div",Re,[X(Ne,{menus:d.value,activeId:(i=f.value)==null?void 0:i.id,activeSubMenuId:(n=p.value)==null?void 0:n.id,onSelect:re},null,8,["menus","activeId","activeSubMenuId"])]),t("div",qe,[t("div",Te,[t("div",Fe,[(s(),o(B,null,L(q,a=>t("button",{key:a.name,class:P(["engine-btn",{active:D.value.name===a.name}]),onClick:I=>oe(a)},m(a.label),11,Oe)),64))]),t("div",Ge,[x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),type:"text",placeholder:D.value.placeholder,class:"search-input",onKeyup:Y(G,["enter"])},null,40,He),[[E,r.value]]),r.value?(s(),o("button",{key:0,class:"clear-btn",onClick:se,"aria-label":"清空",title:"clear"},e[11]||(e[11]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):b("",!0),t("button",{onClick:G,class:"search-btn",title:"search"},e[12]||(e[12]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[t("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])]),g.value.length?(s(),o("div",Je,[(s(!0),o(B,null,L(g.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank"},[t("img",{src:a.img,alt:"广告",loading:"lazy"},null,8,je)],8,Ke))),128))])):b("",!0),_.value.length?(s(),o("div",Qe,[(s(!0),o(B,null,L(_.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank"},[t("img",{src:a.img,alt:"广告",loading:"lazy"},null,8,Xe)],8,We))),128))])):b("",!0),X(we(c),{cards:ne.value},null,8,["cards"]),f.value?(s(),o("button",{key:2,onClick:de,class:"batch-add-btn",title:"批量添加网站"},e[13]||(e[13]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 5v14M5 12h14"})],-1)]))):b("",!0),t("button",{onClick:pe,class:"change-bg-btn",title:"切换背景",disabled:z.value},[z.value?(s(),o("svg",et,e[15]||(e[15]=[t("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"},null,-1)]))):(s(),o("svg",Ze,e[14]||(e[14]=[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},null,-1),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"},null,-1),t("path",{d:"M21 15l-5-5L5 21"},null,-1)])))],8,Ye),R.value?(s(),o("div",{key:3,class:"modal-overlay",onClick:N},[t("div",{class:"modal-content batch-modal",onClick:e[6]||(e[6]=ee(()=>{},["stop"]))},[t("div",tt,[t("h3",null,m(y.value===1?"验证密码":y.value===2?"输入网址":"预览并选择"),1),t("button",{onClick:N,class:"close-btn"},e[16]||(e[16]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",at,[y.value===1?(s(),o("div",lt,[e[18]||(e[18]=t("p",{class:"batch-tip"},"请输入管理员密码以继续：",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>C.value=a),type:"password",placeholder:"请输入管理员密码",class:"batch-input",onKeyup:Y(H,["enter"])},null,544),[[E,C.value]]),t("div",ot,[t("label",null,[x(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=a=>U.value=a)},null,512),[[Z,U.value]]),e[17]||(e[17]=t("span",null,"记住密码（2小时）",-1))])]),v.value?(s(),o("p",st,m(v.value),1)):b("",!0),t("div",nt,[t("button",{onClick:N,class:"btn btn-cancel"},"取消"),t("button",{onClick:H,class:"btn btn-primary",disabled:k.value},m(k.value?"验证中...":"确认"),9,rt)])])):b("",!0),y.value===2?(s(),o("div",it,[e[19]||(e[19]=t("p",{class:"batch-tip"},"请输入需要添加的网址，每行一个：",-1)),x(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>V.value=a),placeholder:`例如：
https://github.com
https://google.com
https://stackoverflow.com`,class:"batch-textarea",rows:"10"},null,512),[[E,V.value]]),v.value?(s(),o("p",dt,m(v.value),1)):b("",!0),t("div",ct,[t("button",{onClick:ue,class:"btn btn-cancel"},"上一步"),t("button",{onClick:ve,class:"btn btn-primary",disabled:k.value||!V.value.trim()},m(k.value?"解析中...":"下一步"),9,ut)])])):b("",!0),y.value===3?(s(),o("div",vt,[e[23]||(e[23]=t("p",{class:"batch-tip"},"请选择需要添加的网站：",-1)),t("div",ht,[(s(!0),o(B,null,L(A.value,(a,I)=>(s(),o("div",{key:I,class:"batch-preview-item"},[x(t("input",{type:"checkbox","onUpdate:modelValue":M=>a.selected=M,id:`card-${I}`},null,8,pt),[[Z,a.selected]]),t("div",gt,[t("img",{src:a.logo,alt:a.title,class:"batch-card-logo",onError:e[4]||(e[4]=M=>M.target.src="/default-favicon.png")},null,40,bt),t("div",mt,[t("div",ft,[e[20]||(e[20]=t("label",null,"标题：",-1)),x(t("input",{type:"text","onUpdate:modelValue":M=>a.title=M,class:"batch-edit-input"},null,8,kt),[[E,a.title]])]),t("div",_t,[e[21]||(e[21]=t("label",null,"Logo：",-1)),x(t("input",{type:"text","onUpdate:modelValue":M=>a.logo=M,class:"batch-edit-input"},null,8,yt),[[E,a.logo]])]),t("div",wt,[e[22]||(e[22]=t("label",null,"描述：",-1)),x(t("textarea",{"onUpdate:modelValue":M=>a.description=M,class:"batch-edit-textarea",rows:"2"},null,8,Ct),[[E,a.description]])]),t("p",Mt,m(a.url),1),a.success?b("",!0):(s(),o("p",St,"⚠️ "+m(a.error),1))])])]))),128))]),v.value?(s(),o("p",It,m(v.value),1)):b("",!0),t("div",xt,[t("button",{onClick:e[5]||(e[5]=a=>y.value=2),class:"btn btn-cancel"},"上一步"),t("button",{onClick:he,class:"btn btn-primary",disabled:k.value||O.value===0},m(k.value?"添加中...":`添加 (${O.value})`),9,$t)])])):b("",!0)])])])):b("",!0),t("footer",Bt,[t("div",Lt,[t("button",{onClick:e[7]||(e[7]=a=>S.value=!0),class:"friend-link-btn"},e[24]||(e[24]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),t("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),te(" 友情链接 ")])),e[25]||(e[25]=t("p",{class:"copyright"},[te("Copyright © 2025 Nav-Item | "),t("a",{href:"https://github.com/zczy-k/nav-item",target:"_blank",class:"footer-link"},"Powered by zczy-k")],-1))])]),S.value?(s(),o("div",{key:4,class:"modal-overlay",onClick:e[10]||(e[10]=a=>S.value=!1)},[t("div",{class:"modal-content",onClick:e[9]||(e[9]=ee(()=>{},["stop"]))},[t("div",Ut,[e[27]||(e[27]=t("h3",null,"友情链接",-1)),t("button",{onClick:e[8]||(e[8]=a=>S.value=!1),class:"close-btn"},e[26]||(e[26]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",Et,[t("div",Vt,[(s(!0),o(B,null,L(F.value,a=>(s(),o("a",{key:a.id,href:a.url,target:"_blank",class:"friend-link-card"},[t("div",zt,[a.logo?(s(),o("img",{key:0,src:a.logo,alt:a.title,loading:"lazy",onError:ie},null,40,Dt)):(s(),o("div",Nt,m(a.title.charAt(0)),1))]),t("div",Pt,[t("h4",null,m(a.title),1)])],8,At))),128))])])])])):b("",!0)])}}},Gt=le(Rt,[["__scopeId","data-v-35284c20"]]);export{Gt as default};
