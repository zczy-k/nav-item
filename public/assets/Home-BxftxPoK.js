const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CardGrid-3PFwKONY.js","assets/index-Dq_6JPbL.js","assets/CardGrid-fBB6b1za.css"])))=>i.map(i=>d[i]);
var he=Object.defineProperty,pe=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var j=(v,u,r)=>u in v?he(v,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):v[u]=r,J=(v,u)=>{for(var r in u||(u={}))ge.call(u,r)&&j(v,r,u[r]);if(O)for(var r of O(u))fe.call(u,r)&&j(v,r,u[r]);return v},Q=(v,u)=>pe(v,be(u));var C=(v,u,r)=>new Promise((k,p)=>{var I=_=>{try{b(r.next(_))}catch(M){p(M)}},n=_=>{try{b(r.throw(_))}catch(M){p(M)}},b=_=>_.done?k(_.value):Promise.resolve(_.value).then(I,n);b((r=r.apply(v,u)).next())});import{_ as ae,r as c,c as s,F as U,a as L,o,b as t,d as g,t as f,n as N,e as W,f as ke,g as X,w as S,v as B,h as Y,u as me,i as _e,j as Z,k as ee,l as te,m as ye}from"./index-Dq_6JPbL.js";import{g as we,a as Ce,b as Me,c as le,d as xe,l as Se,e as Ie,f as $e}from"./api-KwLLGkf8.js";const Ue={class:"menu-bar"},Le=["onMouseenter","onMouseleave"],Be=["onClick"],Ve=["onClick"],Ae={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},setup(v){const u=c(null);function r(p){u.value=p}function k(p){setTimeout(()=>{u.value===p&&(u.value=null)},100)}return(p,I)=>(o(),s("nav",Ue,[(o(!0),s(U,null,L(v.menus,n=>(o(),s("div",{key:n.id,class:"menu-item",onMouseenter:b=>r(n.id),onMouseleave:b=>k(n.id)},[t("button",{onClick:b=>p.$emit("select",n),class:N({active:n.id===v.activeId})},f(n.name),11,Be),n.subMenus&&n.subMenus.length>0?(o(),s("div",{key:0,class:N(["sub-menu",{show:u.value===n.id}])},[(o(!0),s(U,null,L(n.subMenus,b=>(o(),s("button",{key:b.id,onClick:_=>p.$emit("select",b,n),class:N([{active:b.id===v.activeSubMenuId},"sub-menu-item"])},f(b.name),11,Ve))),128))],2)):g("",!0)],40,Le))),128))]))}},Ee=ae(Ae,[["__scopeId","data-v-16a94230"]]),ze={class:"home-container"},Re={class:"menu-bar-fixed"},Pe={class:"search-section"},Ne={class:"search-box-wrapper"},qe={class:"search-engine-select"},Te=["onClick"],De={class:"search-container"},Fe=["placeholder"],Ge={key:0,class:"ad-space-fixed left-ad-fixed"},He=["href"],Ke=["src"],Oe={key:1,class:"ad-space-fixed right-ad-fixed"},je=["href"],Je=["src"],Qe=["disabled"],We={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Xe={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ye={class:"modal-header"},Ze={class:"modal-body"},et={key:0,class:"batch-step"},tt={class:"remember-password-wrapper"},lt={key:0,class:"batch-error"},at={class:"batch-actions"},st=["disabled"],ot={key:1,class:"batch-step"},nt={key:0,class:"batch-error"},rt={class:"batch-actions"},it=["disabled"],dt={key:2,class:"batch-step"},ut={class:"batch-preview-list"},ct=["onUpdate:modelValue","id"],vt={class:"batch-card-preview"},ht=["src","alt"],pt={class:"batch-card-info"},bt={class:"batch-edit-field"},gt=["onUpdate:modelValue"],ft={class:"batch-edit-field"},kt=["onUpdate:modelValue"],mt={class:"batch-edit-field"},_t=["onUpdate:modelValue"],yt={class:"batch-card-url"},wt={key:0,class:"batch-card-warning"},Ct={key:0,class:"batch-error"},Mt={class:"batch-actions"},xt=["disabled"],St={class:"footer"},It={class:"footer-content"},$t={class:"modal-header"},Ut={class:"modal-body"},Lt={class:"friend-links-grid"},Bt=["href"],Vt={class:"friend-link-logo"},At=["src","alt"],Et={key:1,class:"friend-link-placeholder"},zt={class:"friend-link-info"},Rt={__name:"Home",setup(v){const u=_e(()=>ye(()=>import("./CardGrid-3PFwKONY.js"),__vite__mapDeps([0,1,2]))),r=c([]),k=c(null),p=c(null),I=c([]),n=c(""),b=c([]),_=c([]),M=c(!1),D=c([]),q=c(!1),y=c(1),$=c(""),V=c(""),m=c(!1),h=c(""),A=c([]),R=c(!1),E=c(!1),F=W(()=>A.value.filter(a=>a.selected).length),G=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:a=>`https://www.google.com/search?q=${encodeURIComponent(a)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:a=>`https://www.baidu.com/s?wd=${encodeURIComponent(a)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:a=>`https://www.bing.com/search?q=${encodeURIComponent(a)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:a=>`https://github.com/search?q=${encodeURIComponent(a)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:a=>`/search?query=${encodeURIComponent(a)}`}],z=c(G[0]);function se(a){z.value=a}function oe(){n.value=""}const ne=W(()=>n.value?I.value.filter(a=>a.title.toLowerCase().includes(n.value.toLowerCase())||a.url.toLowerCase().includes(n.value.toLowerCase())):I.value);ke(()=>C(null,null,function*(){const a=yield we();r.value=a.data,r.value.length&&(k.value=r.value[0],T());const e=yield Ce();b.value=e.data.filter(l=>l.position==="left"),_.value=e.data.filter(l=>l.position==="right");const i=yield Me();D.value=i.data;const d=localStorage.getItem("nav_background");d&&setTimeout(()=>{const l=document.querySelector(".home-container");l&&(l.style.backgroundImage=`url(${d})`,l.style.backgroundSize="cover",l.style.backgroundPosition="center",l.style.backgroundRepeat="no-repeat",l.style.backgroundAttachment="fixed")},0),de()}));function re(a,e=null){return C(this,null,function*(){e?(k.value=e,p.value=a):(k.value=a,p.value=null),T()})}function T(){return C(this,null,function*(){var e;if(!k.value)return;const a=yield le(k.value.id,(e=p.value)==null?void 0:e.id);I.value=a.data})}function H(){return C(this,null,function*(){if(n.value.trim())if(z.value.name==="site"){let a=!1;for(const e of r.value){const i=yield le(e.id),d=i.data.find(l=>l.title.toLowerCase().includes(n.value.toLowerCase())||l.url.toLowerCase().includes(n.value.toLowerCase()));if(d){k.value=e,I.value=i.data,setTimeout(()=>{const l=document.querySelector(`[data-card-id='${d.id}']`);l&&l.scrollIntoView({behavior:"smooth",block:"center"})},100),a=!0;break}}a||alert("未找到相关内容")}else{const a=z.value.url(n.value);window.open(a,"_blank")}})}function ie(a){a.target.style.display="none",a.target.nextElementSibling.style.display="flex"}function P(){q.value=!1,y.value=1,$.value="",V.value="",h.value="",A.value=[],m.value=!1}function de(){const a=localStorage.getItem("nav_password_token");if(a)try{const{password:e,expiry:i,token:d}=JSON.parse(a);Date.now()<i?($.value=e,R.value=!0,d&&localStorage.setItem("token",d)):localStorage.removeItem("nav_password_token")}catch(e){localStorage.removeItem("nav_password_token")}}function K(){return C(this,null,function*(){if(!$.value){h.value="请输入密码";return}m.value=!0,h.value="";try{const a=yield Se("admin",$.value);if(a.data&&a.data.token)localStorage.setItem("token",a.data.token);else throw new Error("登录成功，但未收到 token");if(R.value){const e=Date.now()+72e5;localStorage.setItem("nav_password_token",JSON.stringify({password:$.value,token:a.data.token,expiry:e}))}else localStorage.removeItem("nav_password_token");y.value=2}catch(a){h.value="密码错误，请重试",console.error("密码验证失败:",a)}finally{m.value=!1}})}function ue(){return C(this,null,function*(){var e,i;const a=V.value.split(`
`).map(d=>d.trim()).filter(d=>d.length>0);if(a.length===0){h.value="请输入至少一个网址";return}m.value=!0,h.value="";try{const d=yield Ie(a);A.value=d.data.data.map(l=>Q(J({},l),{selected:!0})),y.value=3}catch(d){h.value=((i=(e=d.response)==null?void 0:e.data)==null?void 0:i.error)||"解析失败，请重试"}finally{m.value=!1}})}function ce(){return C(this,null,function*(){var e,i,d;const a=A.value.filter(l=>l.selected);if(a.length===0){h.value="请至少选择一个网站";return}m.value=!0,h.value="";try{const l=a.map(x=>({title:x.title,url:x.url,logo:x.logo,description:x.description}));yield $e(k.value.id,((e=p.value)==null?void 0:e.id)||null,l),alert(`成功添加 ${a.length} 个网站！`),P(),yield T()}catch(l){h.value=((d=(i=l.response)==null?void 0:i.data)==null?void 0:d.error)||"添加失败，请重试"}finally{m.value=!1}})}function ve(){return C(this,null,function*(){if(!E.value){E.value=!0;try{const e=(yield xe()).data.url,i=document.querySelector(".home-container");i&&(i.style.backgroundImage=`url(${e})`,i.style.backgroundSize="cover",i.style.backgroundPosition="center",i.style.backgroundRepeat="no-repeat",i.style.backgroundAttachment="fixed"),localStorage.setItem("nav_background",e)}catch(a){console.error("获取壁纸失败:",a),alert("获取壁纸失败，请稍后重试")}finally{E.value=!1}}})}return(a,e)=>{var i,d;return o(),s("div",ze,[t("div",Re,[X(Ee,{menus:r.value,activeId:(i=k.value)==null?void 0:i.id,activeSubMenuId:(d=p.value)==null?void 0:d.id,onSelect:re},null,8,["menus","activeId","activeSubMenuId"])]),t("div",Pe,[t("div",Ne,[t("div",qe,[(o(),s(U,null,L(G,l=>t("button",{key:l.name,class:N(["engine-btn",{active:z.value.name===l.name}]),onClick:x=>se(l)},f(l.label),11,Te)),64))]),t("div",De,[S(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>n.value=l),type:"text",placeholder:z.value.placeholder,class:"search-input",onKeyup:Y(H,["enter"])},null,40,Fe),[[B,n.value]]),n.value?(o(),s("button",{key:0,class:"clear-btn",onClick:oe,"aria-label":"清空",title:"clear"},e[13]||(e[13]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):g("",!0),t("button",{onClick:H,class:"search-btn",title:"search"},e[14]||(e[14]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[t("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])]),b.value.length?(o(),s("div",Ge,[(o(!0),s(U,null,L(b.value,l=>(o(),s("a",{key:l.id,href:l.url,target:"_blank"},[t("img",{src:l.img,alt:"广告",loading:"lazy"},null,8,Ke)],8,He))),128))])):g("",!0),_.value.length?(o(),s("div",Oe,[(o(!0),s(U,null,L(_.value,l=>(o(),s("a",{key:l.id,href:l.url,target:"_blank"},[t("img",{src:l.img,alt:"广告",loading:"lazy"},null,8,Je)],8,je))),128))])):g("",!0),X(me(u),{cards:ne.value},null,8,["cards"]),k.value?(o(),s("button",{key:2,onClick:e[1]||(e[1]=l=>q.value=!0),class:"batch-add-btn",title:"批量添加网站"},e[15]||(e[15]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 5v14M5 12h14"})],-1)]))):g("",!0),t("button",{onClick:ve,class:"change-bg-btn",title:"切换背景",disabled:E.value},[E.value?(o(),s("svg",Xe,e[17]||(e[17]=[t("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"},null,-1)]))):(o(),s("svg",We,e[16]||(e[16]=[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},null,-1),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"},null,-1),t("path",{d:"M21 15l-5-5L5 21"},null,-1)])))],8,Qe),q.value?(o(),s("div",{key:3,class:"modal-overlay",onClick:P},[t("div",{class:"modal-content batch-modal",onClick:e[8]||(e[8]=ee(()=>{},["stop"]))},[t("div",Ye,[t("h3",null,f(y.value===1?"验证密码":y.value===2?"输入网址":"预览并选择"),1),t("button",{onClick:P,class:"close-btn"},e[18]||(e[18]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",Ze,[y.value===1?(o(),s("div",et,[e[20]||(e[20]=t("p",{class:"batch-tip"},"请输入管理员密码以继续：",-1)),S(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>$.value=l),type:"password",placeholder:"请输入管理员密码",class:"batch-input",onKeyup:Y(K,["enter"])},null,544),[[B,$.value]]),t("div",tt,[t("label",null,[S(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=l=>R.value=l)},null,512),[[Z,R.value]]),e[19]||(e[19]=t("span",null,"记住密码（2小时）",-1))])]),h.value?(o(),s("p",lt,f(h.value),1)):g("",!0),t("div",at,[t("button",{onClick:P,class:"btn btn-cancel"},"取消"),t("button",{onClick:K,class:"btn btn-primary",disabled:m.value},f(m.value?"验证中...":"确认"),9,st)])])):g("",!0),y.value===2?(o(),s("div",ot,[e[21]||(e[21]=t("p",{class:"batch-tip"},"请输入需要添加的网址，每行一个：",-1)),S(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=l=>V.value=l),placeholder:`例如：
https://github.com
https://google.com
https://stackoverflow.com`,class:"batch-textarea",rows:"10"},null,512),[[B,V.value]]),h.value?(o(),s("p",nt,f(h.value),1)):g("",!0),t("div",rt,[t("button",{onClick:e[5]||(e[5]=l=>y.value=1),class:"btn btn-cancel"},"上一步"),t("button",{onClick:ue,class:"btn btn-primary",disabled:m.value||!V.value.trim()},f(m.value?"解析中...":"下一步"),9,it)])])):g("",!0),y.value===3?(o(),s("div",dt,[e[25]||(e[25]=t("p",{class:"batch-tip"},"请选择需要添加的网站：",-1)),t("div",ut,[(o(!0),s(U,null,L(A.value,(l,x)=>(o(),s("div",{key:x,class:"batch-preview-item"},[S(t("input",{type:"checkbox","onUpdate:modelValue":w=>l.selected=w,id:`card-${x}`},null,8,ct),[[Z,l.selected]]),t("div",vt,[t("img",{src:l.logo,alt:l.title,class:"batch-card-logo",onError:e[6]||(e[6]=w=>w.target.src="/default-favicon.png")},null,40,ht),t("div",pt,[t("div",bt,[e[22]||(e[22]=t("label",null,"标题：",-1)),S(t("input",{type:"text","onUpdate:modelValue":w=>l.title=w,class:"batch-edit-input"},null,8,gt),[[B,l.title]])]),t("div",ft,[e[23]||(e[23]=t("label",null,"Logo：",-1)),S(t("input",{type:"text","onUpdate:modelValue":w=>l.logo=w,class:"batch-edit-input"},null,8,kt),[[B,l.logo]])]),t("div",mt,[e[24]||(e[24]=t("label",null,"描述：",-1)),S(t("textarea",{"onUpdate:modelValue":w=>l.description=w,class:"batch-edit-textarea",rows:"2"},null,8,_t),[[B,l.description]])]),t("p",yt,f(l.url),1),l.success?g("",!0):(o(),s("p",wt,"⚠️ "+f(l.error),1))])])]))),128))]),h.value?(o(),s("p",Ct,f(h.value),1)):g("",!0),t("div",Mt,[t("button",{onClick:e[7]||(e[7]=l=>y.value=2),class:"btn btn-cancel"},"上一步"),t("button",{onClick:ce,class:"btn btn-primary",disabled:m.value||F.value===0},f(m.value?"添加中...":`添加 (${F.value})`),9,xt)])])):g("",!0)])])])):g("",!0),t("footer",St,[t("div",It,[t("button",{onClick:e[9]||(e[9]=l=>M.value=!0),class:"friend-link-btn"},e[26]||(e[26]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),t("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),te(" 友情链接 ")])),e[27]||(e[27]=t("p",{class:"copyright"},[te("Copyright © 2025 Nav-Item | "),t("a",{href:"https://github.com/zczy-k/nav-item",target:"_blank",class:"footer-link"},"Powered by zczy-k")],-1))])]),M.value?(o(),s("div",{key:4,class:"modal-overlay",onClick:e[12]||(e[12]=l=>M.value=!1)},[t("div",{class:"modal-content",onClick:e[11]||(e[11]=ee(()=>{},["stop"]))},[t("div",$t,[e[29]||(e[29]=t("h3",null,"友情链接",-1)),t("button",{onClick:e[10]||(e[10]=l=>M.value=!1),class:"close-btn"},e[28]||(e[28]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),t("div",Ut,[t("div",Lt,[(o(!0),s(U,null,L(D.value,l=>(o(),s("a",{key:l.id,href:l.url,target:"_blank",class:"friend-link-card"},[t("div",Vt,[l.logo?(o(),s("img",{key:0,src:l.logo,alt:l.title,loading:"lazy",onError:ie},null,40,At)):(o(),s("div",Et,f(l.title.charAt(0)),1))]),t("div",zt,[t("h4",null,f(l.title),1)])],8,Bt))),128))])])])])):g("",!0)])}}},Tt=ae(Rt,[["__scopeId","data-v-3ae8a527"]]);export{Tt as default};
